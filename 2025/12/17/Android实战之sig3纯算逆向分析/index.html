<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Androidå®æˆ˜ä¹‹sig3çº¯ç®—é€†å‘åˆ†æ | S1nec-1o's B1og</title><meta name="author" content="s1nec-1o"><meta name="copyright" content="s1nec-1o"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="æœ¬æ–‡ç« å†…å®¹ä»…ç”¨äºé€†å‘å­¦ä¹ ï¼Œè¯·å‹¿ç”¨äºé»‘äº§è¡Œä¸ºï¼Œå¦‚æœ‰ä¾µæƒï¼Œè¯·è”ç³»æœ¬äººåˆ é™¤ï¼Œæœªç»æœ¬äººå…è®¸ï¼Œä¸å¯è½¬è½½ã€‚ æŠ“åŒ…åˆ†æQUICé™çº§ï¼š QUICæ˜¯åŸºäº UDP åè®® çš„ ä¸»æµæŠ“åŒ…å·¥å…·ï¼Œæœ¬è´¨ä¸Šæ˜¯å»ºç«‹ä¸€ä¸ª HTTP&#x2F;HTTPS ä»£ç†æœåŠ¡å™¨ã€‚å®ƒä»¬ä¸»è¦å·¥ä½œåœ¨ TCP åè®® ä¹‹ä¸Š å› æ­¤éœ€è¦è®©å®ƒæ”¾å¼ƒä½¿ç”¨UDPè€Œä½¿ç”¨TCPï¼Œå› æ­¤è¦å…ˆé™çº§å¤„ç† æ­£å¸¸æŠ“åŒ…åªæœ‰okhttpdèµ°ä»£ç†ï¼Œè¦å…ˆé™çº§æŠ“åŒ…ï¼Œjadxæœç´¢cronetCo">
<meta property="og:type" content="article">
<meta property="og:title" content="Androidå®æˆ˜ä¹‹sig3çº¯ç®—é€†å‘åˆ†æ">
<meta property="og:url" content="http://s1nec-1o.github.io/2025/12/17/Android%E5%AE%9E%E6%88%98%E4%B9%8Bsig3%E7%BA%AF%E7%AE%97%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/index.html">
<meta property="og:site_name" content="S1nec-1o&#39;s B1og">
<meta property="og:description" content="æœ¬æ–‡ç« å†…å®¹ä»…ç”¨äºé€†å‘å­¦ä¹ ï¼Œè¯·å‹¿ç”¨äºé»‘äº§è¡Œä¸ºï¼Œå¦‚æœ‰ä¾µæƒï¼Œè¯·è”ç³»æœ¬äººåˆ é™¤ï¼Œæœªç»æœ¬äººå…è®¸ï¼Œä¸å¯è½¬è½½ã€‚ æŠ“åŒ…åˆ†æQUICé™çº§ï¼š QUICæ˜¯åŸºäº UDP åè®® çš„ ä¸»æµæŠ“åŒ…å·¥å…·ï¼Œæœ¬è´¨ä¸Šæ˜¯å»ºç«‹ä¸€ä¸ª HTTP&#x2F;HTTPS ä»£ç†æœåŠ¡å™¨ã€‚å®ƒä»¬ä¸»è¦å·¥ä½œåœ¨ TCP åè®® ä¹‹ä¸Š å› æ­¤éœ€è¦è®©å®ƒæ”¾å¼ƒä½¿ç”¨UDPè€Œä½¿ç”¨TCPï¼Œå› æ­¤è¦å…ˆé™çº§å¤„ç† æ­£å¸¸æŠ“åŒ…åªæœ‰okhttpdèµ°ä»£ç†ï¼Œè¦å…ˆé™çº§æŠ“åŒ…ï¼Œjadxæœç´¢cronetCo">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281614288.png">
<meta property="article:published_time" content="2025-12-17T08:41:37.000Z">
<meta property="article:modified_time" content="2025-12-17T08:42:59.001Z">
<meta property="article:author" content="s1nec-1o">
<meta property="article:tag" content="android">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281614288.png"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281712481.jpg"><link rel="canonical" href="http://s1nec-1o.github.io/2025/12/17/Android%E5%AE%9E%E6%88%98%E4%B9%8Bsig3%E7%BA%AF%E7%AE%97%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><link rel="stylesheet" href="/css/index.css?v=4.12.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"è·ç¦»æ–‡ç« å‘å¸ƒå·²ç»è¿‡å»","messageNext":"å¤©äº†ï¼Œä¿¡æ¯å¯èƒ½å·²ç»è¿‡æ—¶"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.0/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Androidå®æˆ˜ä¹‹sig3çº¯ç®—é€†å‘åˆ†æ',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-12-17 16:42:59'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 8 || hour >= 20
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="S1nec-1o's B1og" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281614288.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">52</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">18</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">26</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281616326.png')"><nav id="nav"><span id="blog-info"><a href="/" title="S1nec-1o's B1og"><span class="site-name">S1nec-1o's B1og</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Androidå®æˆ˜ä¹‹sig3çº¯ç®—é€†å‘åˆ†æ</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2025-12-17T08:41:37.000Z" title="å‘è¡¨äº 2025-12-17 16:41:37">2025-12-17</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2025-12-17T08:42:59.001Z" title="æ›´æ–°äº 2025-12-17 16:42:59">2025-12-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%89%E5%8D%93%E9%80%86%E5%90%91/">å®‰å“é€†å‘</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><strong>æœ¬æ–‡ç« å†…å®¹ä»…ç”¨äºé€†å‘å­¦ä¹ ï¼Œè¯·å‹¿ç”¨äºé»‘äº§è¡Œä¸ºï¼Œå¦‚æœ‰ä¾µæƒï¼Œè¯·è”ç³»æœ¬äººåˆ é™¤ï¼Œæœªç»æœ¬äººå…è®¸ï¼Œä¸å¯è½¬è½½ã€‚</strong></p>
<h2 id="æŠ“åŒ…åˆ†æ"><a href="#æŠ“åŒ…åˆ†æ" class="headerlink" title="æŠ“åŒ…åˆ†æ"></a>æŠ“åŒ…åˆ†æ</h2><p>QUICé™çº§ï¼š</p>
<p>QUICæ˜¯åŸºäº <strong>UDP åè®®</strong> çš„</p>
<p>ä¸»æµæŠ“åŒ…å·¥å…·ï¼Œæœ¬è´¨ä¸Šæ˜¯å»ºç«‹ä¸€ä¸ª <strong>HTTP&#x2F;HTTPS ä»£ç†æœåŠ¡å™¨</strong>ã€‚å®ƒä»¬ä¸»è¦å·¥ä½œåœ¨ <strong>TCP åè®®</strong> ä¹‹ä¸Š</p>
<p>å› æ­¤éœ€è¦è®©å®ƒæ”¾å¼ƒä½¿ç”¨UDPè€Œä½¿ç”¨TCPï¼Œå› æ­¤è¦å…ˆé™çº§å¤„ç†</p>
<p>æ­£å¸¸æŠ“åŒ…åªæœ‰okhttpdèµ°ä»£ç†ï¼Œè¦å…ˆé™çº§æŠ“åŒ…ï¼Œjadxæœç´¢<code>cronetConfig</code>æ‰¾åˆ°å¯¹åº”è®¾ç½®é…ç½®çš„åœ°æ–¹ï¼Œæ‰“å¼€<strong>libageon.so</strong>å¹¶æœç´¢å­—ç¬¦ä¸²<code>enable_quic</code>å¯ä»¥æ‰¾åˆ°å¤„ç†é…ç½®çš„åœ°æ–¹</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">clazz.<span class="property">c</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">a,b</span>)&#123;</span><br><span class="line">    <span class="title function_">showStacks</span>();</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[c]args1-&gt; &quot;</span>,a,<span class="string">&quot;  &quot;</span>,<span class="string">&quot;args2-&gt; &quot;</span>,b);</span><br><span class="line">    <span class="keyword">if</span>(a == <span class="string">&quot;cronetConfig&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> replace = <span class="string">&quot;&#123;\&quot;enable_quic\&quot;: false, \&quot;enable_http2\&quot;: false&#125;&quot;</span></span><br><span class="line">        <span class="keyword">var</span> retval1 = <span class="variable language_">this</span>.<span class="title function_">c</span>(a,replace);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[replace]retval-&gt; &quot;</span>,retval1);</span><br><span class="line">        <span class="keyword">return</span> retval1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> retval3 = <span class="variable language_">this</span>.<span class="title function_">c</span>(a,b);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[original]retval-&gt; &quot;</span>,retval3);</span><br><span class="line">    <span class="keyword">return</span> retval3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åå°±å¯ä»¥æ­£å¸¸æŠ“åˆ°å¸¦sig3çš„åŒ…äº†</p>
<p>ä½¿ç”¨reqableè¿›è¡ŒæŠ“åŒ…</p>
<h2 id="Javaå±‚æµ…æ"><a href="#Javaå±‚æµ…æ" class="headerlink" title="Javaå±‚æµ…æ"></a>Javaå±‚æµ…æ</h2><p>å­—ç¬¦ä¸²æœç´¢sig3å¾ˆå®¹æ˜“æ‰¾åˆ°ä¼ å…¥é€»è¾‘ï¼Œå°±ä¸å¤šè¯´äº†ï¼ˆåœ¨å…¶ä»–ä¾‹å­ä¸­å¯èƒ½ä¼šå‡ºç°æ²¡æ‰¾åˆ°çš„æƒ…å†µï¼Œå¯ä»¥é€šè¿‡hook hash.putæˆ–è€…å…¶ä»–å¯èƒ½çš„javaæ–¹æ³•ï¼Œå¾ˆå–œæ¬¢é€šè¿‡è¿™äº›æ–¹æ³•å°†headeræ”¾è¿›å»ï¼Œä¾‹å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼‰</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">HashMap</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.util.HashMap&quot;</span>);</span><br><span class="line">   </span><br><span class="line">    <span class="title class_">HashMap</span>.<span class="property">put</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.Object&#x27;</span>, <span class="string">&#x27;java.lang.Object&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">key, value</span>) &#123;</span><br><span class="line">       </span><br><span class="line">        <span class="keyword">if</span> (key !== <span class="literal">null</span> &amp;&amp; key.<span class="title function_">toString</span>() === <span class="string">&quot;__NS_sig3&quot;</span>) &#123;</span><br><span class="line">           </span><br><span class="line">            <span class="title function_">showStacks</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[+] Value (__NS_sig3): &quot;</span> + value);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">put</span>(key, value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">put</span>(key, value);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hook win -&gt; &quot;</span>,<span class="title class_">HashMap</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[vd6.r.b]r.b is called: str=/rest/n/feed/selectionfb4e77xxxxxxx2541</span><br><span class="line">[vd6.r.b]r.b result=cedfaf8xxxxx59b97998f</span><br></pre></td></tr></table></figure>

<p>Javaå±‚å…¥å£ä¼ å…¥<code>/rest/n/feed/selectionfb4e77xxxxx2541</code></p>
<p>å…¶ä¸­<code>/rest/n/feed/selection</code>æ˜¯APIæ¥å£ï¼Œ<code>fb4e77xxxxxxx2541</code>æ˜¯sigçš„å€¼</p>
<h3 id="sigæŒ‡çº¹"><a href="#sigæŒ‡çº¹" class="headerlink" title="sigæŒ‡çº¹"></a>sigæŒ‡çº¹</h3><p>sigæ˜¯é€šè¿‡ä¼ å…¥çš„requestå¾—åˆ°çš„</p>
<p>sigæ˜¯é€šè¿‡<code>ce6.d$d.d</code>è·å–çš„ï¼Œæ‹¿ä¸€ä¸ªæ —å­</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ce6.d$d.d]ce6.d$d.d is called: abi=androidApiLevel=android_os=app=appver=boardPlatform=bottom_navigation=browseType=c=cdid_tag=clientRealReportData=client_key=cold=coldStart=cold_launch_time_ms=count=country_code=cs=darkMode=ddpi=deviceBit=device_abi=did=did_gt=did_tag=earphoneMode=edgeRecoBit=edgeRerankConfigVersion=egid=ftt=grant_browse_type=hotfix_ver=injectTask=isOpenAutoPlay=is_background=isp=iuid=kcv=keyconfig_state=kpf=kpn=language=max_memory=mod=nbh=net=newOc=newUserAction=newUserRefreshTimes=oDid=oc=os=page=pcursor=pv=rdid=realShowPhotoIds=recoReportContext=sbh=seid=sh=slh=socName=source=sw=sys=teenageAge=thermal=totalMemory=uQaTag=ud=userRecoBit=ver=videoModelCrowdTag=result=</span><br></pre></td></tr></table></figure>

<p>æ‰”ç»™geminiåˆ†æä¸€ä¸‹</p>
<p><strong>ç¬¬ä¸€éƒ¨åˆ†ï¼šè®¾å¤‡å”¯ä¸€æ ‡è¯† (Device Identifiers)</strong></p>
<p>è¿™äº›å‚æ•°ç”¨äºå”¯ä¸€æ ‡è¯†ä¸€å°è®¾å¤‡ï¼Œæ˜¯é£æ§æœ€å…³æ³¨çš„éƒ¨åˆ†ã€‚</p>
<table>
<thead>
<tr>
<th><strong>Key</strong></th>
<th><strong>Value</strong></th>
<th><strong>è¯´æ˜</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>abi</strong></td>
<td><code>******</code></td>
<td>CPU æ¶æ„æŒ‡ä»¤é›† (Application Binary Interface)ã€‚</td>
</tr>
<tr>
<td><strong>boardPlatform</strong></td>
<td><code>******</code></td>
<td>èŠ¯ç‰‡å¹³å°ä»£å· (è¿™é‡ŒæŒ‡ Google Tensor èŠ¯ç‰‡)ã€‚</td>
</tr>
<tr>
<td><strong>cdid_tag</strong></td>
<td><code>******</code></td>
<td>è®¾å¤‡ ID ç›¸å…³çš„æ ‡ç­¾ï¼Œç”¨äºåŒºåˆ† ID ç±»å‹æˆ–çŠ¶æ€ã€‚</td>
</tr>
<tr>
<td><strong>ddpi</strong></td>
<td><code>******</code></td>
<td>å±å¹•åƒç´ å¯†åº¦ (Density DPI)ã€‚</td>
</tr>
<tr>
<td><strong>deviceBit</strong></td>
<td><code>******</code></td>
<td>è®¾å¤‡ä½å®½æ ‡è¯† (å¯èƒ½æŒ‡ 32&#x2F;64 ä½æˆ–å…¶ä»–ç‰¹æ€§)ã€‚</td>
</tr>
<tr>
<td><strong>device_abi</strong></td>
<td><code>******</code></td>
<td>åŒ abiï¼Œè®¾å¤‡æ”¯æŒçš„æŒ‡ä»¤é›†ã€‚</td>
</tr>
<tr>
<td><strong>did</strong></td>
<td><code>******</code></td>
<td><strong>æ ¸å¿ƒè®¾å¤‡ ID</strong> (Device ID)ï¼Œæœ€å…³é”®çš„é£æ§æ ‡è¯†ã€‚</td>
</tr>
<tr>
<td><strong>did_gt</strong></td>
<td><code>******</code></td>
<td>Device ID ç”Ÿæˆçš„æ—¶é—´æˆ³ (Generate Time)ã€‚</td>
</tr>
<tr>
<td><strong>did_tag</strong></td>
<td><code>******</code></td>
<td>å¦ä¸€ä¸ªè®¾å¤‡ ID æ ‡ç­¾ã€‚</td>
</tr>
<tr>
<td><strong>egid</strong></td>
<td><code>******</code></td>
<td>æ‰©å±•å…¨å±€ ID (Extended Global ID)ï¼Œé•¿æŒ‡çº¹å­—ç¬¦ä¸²ã€‚</td>
</tr>
<tr>
<td><strong>max_memory</strong></td>
<td><code>******</code></td>
<td>App å¯ä½¿ç”¨çš„æœ€å¤§å†…å­˜é™åˆ¶ (MB)ã€‚</td>
</tr>
<tr>
<td><strong>mod</strong></td>
<td><code>******</code></td>
<td>æ‰‹æœºå‹å· (Model)ã€‚</td>
</tr>
<tr>
<td><strong>oDid</strong></td>
<td><code>******</code></td>
<td>åŸå§‹è®¾å¤‡ ID (Original Device ID)ï¼Œå¯èƒ½æŒ‡æœªé‡ç½®å‰çš„ IDã€‚</td>
</tr>
<tr>
<td><strong>rdid</strong></td>
<td><code>******</code></td>
<td>éšæœºè®¾å¤‡ ID (Random Device ID)ã€‚</td>
</tr>
<tr>
<td><strong>socName</strong></td>
<td><code>******</code></td>
<td>èŠ¯ç‰‡å‹å·åç§° (System on Chip)ã€‚</td>
</tr>
<tr>
<td><strong>sw</strong></td>
<td><code>******</code></td>
<td>å±å¹•å®½åº¦ (Screen Width)ã€‚</td>
</tr>
<tr>
<td><strong>sh</strong></td>
<td><code>******</code></td>
<td>å±å¹•é«˜åº¦ (Screen Height)ã€‚</td>
</tr>
<tr>
<td><strong>thermal</strong></td>
<td><code>******</code></td>
<td>çƒ­çŠ¶æ€&#x2F;æ¸©åº¦ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td><strong>totalMemory</strong></td>
<td><code>******</code></td>
<td>è®¾å¤‡æ€»å†…å­˜ (MB)ã€‚</td>
</tr>
</tbody></table>
<hr>
<p><strong>ç¬¬äºŒéƒ¨åˆ†ï¼šç³»ç»Ÿä¸ç¯å¢ƒä¿¡æ¯ (System &amp; Env)</strong></p>
<p>è¿™äº›å‚æ•°æè¿° App è¿è¡Œçš„è½¯ä»¶ç¯å¢ƒã€‚</p>
<table>
<thead>
<tr>
<th><strong>Key</strong></th>
<th><strong>Value</strong></th>
<th><strong>è¯´æ˜</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>androidApiLevel</strong></td>
<td><code>******</code></td>
<td>Android SDK ç‰ˆæœ¬ (33 å¯¹åº” Android 13)ã€‚</td>
</tr>
<tr>
<td><strong>android_os</strong></td>
<td><code>******</code></td>
<td>æ“ä½œç³»ç»Ÿæ ‡è¯† (0 å¯èƒ½ä»£è¡¨åŸç”Ÿ Android)ã€‚</td>
</tr>
<tr>
<td><strong>app</strong></td>
<td><code>******</code></td>
<td>App ç±»å‹æ ‡è¯† (0 é€šå¸¸æŒ‡ä¸» App)ã€‚</td>
</tr>
<tr>
<td><strong>appver</strong></td>
<td><code>******</code></td>
<td><strong>App è¯¦ç»†ç‰ˆæœ¬å·</strong>ï¼Œç­¾åè®¡ç®—çš„å…³é”®ã€‚</td>
</tr>
<tr>
<td><strong>channel (c)</strong></td>
<td><code>******</code></td>
<td>App å®‰è£…æ¸ é“ (VIVO åº”ç”¨å•†åº—)ã€‚</td>
</tr>
<tr>
<td><strong>country_code</strong></td>
<td><code>******</code></td>
<td>å›½å®¶ä»£ç  (ä¸­å›½)ã€‚</td>
</tr>
<tr>
<td><strong>cs</strong></td>
<td><code>******</code></td>
<td>å¯èƒ½æŒ‡ Cold Start (å†·å¯åŠ¨) çš„ç¼©å†™ï¼Œæˆ–è€…æ˜¯æŸç§å¼€å…³çŠ¶æ€ã€‚</td>
</tr>
<tr>
<td><strong>darkMode</strong></td>
<td><code>******</code></td>
<td>æ·±è‰²æ¨¡å¼çŠ¶æ€ã€‚</td>
</tr>
<tr>
<td><strong>earphoneMode</strong></td>
<td><code>******</code></td>
<td>è€³æœºæ¨¡å¼çŠ¶æ€ (0: æœªæ’å…¥)ã€‚</td>
</tr>
<tr>
<td><strong>hotfix_ver</strong></td>
<td><code>******</code></td>
<td>çƒ­ä¿®å¤ç‰ˆæœ¬å·ã€‚</td>
</tr>
<tr>
<td><strong>is_background</strong></td>
<td><code>******</code></td>
<td>æ˜¯å¦åœ¨åå°è¿è¡Œ (1: æ˜¯)ã€‚</td>
</tr>
<tr>
<td><strong>isp</strong></td>
<td><code>******</code></td>
<td>è¿è¥å•†ä¿¡æ¯ (Internet Service Provider)ã€‚</td>
</tr>
<tr>
<td><strong>keyconfig_state</strong></td>
<td><code>******</code></td>
<td>é”®å€¼é…ç½®çŠ¶æ€ã€‚</td>
</tr>
<tr>
<td><strong>kpf</strong></td>
<td><code>******</code></td>
<td>å¹³å°æ ‡è¯† (Kwai Platform Form - Android Phone)ã€‚</td>
</tr>
<tr>
<td><strong>kpn</strong></td>
<td><code>******</code></td>
<td>äº§å“æ ‡è¯† (Kwai Product Name - å¿«æ‰‹ä¸»ç«™)ã€‚</td>
</tr>
<tr>
<td><strong>language</strong></td>
<td><code>******</code></td>
<td>ç³»ç»Ÿè¯­è¨€ã€‚</td>
</tr>
<tr>
<td><strong>net</strong></td>
<td><code>******</code></td>
<td>ç½‘ç»œçŠ¶æ€ã€‚</td>
</tr>
<tr>
<td><strong>newOc</strong></td>
<td><code>******</code></td>
<td>æ–°æ¸ é“æ ‡è¯† (New Original Channel)ã€‚</td>
</tr>
<tr>
<td><strong>oc</strong></td>
<td><code>******</code></td>
<td>åŸå§‹æ¸ é“ (Original Channel)ã€‚</td>
</tr>
<tr>
<td><strong>os</strong></td>
<td><code>******</code></td>
<td>æ“ä½œç³»ç»Ÿåç§°ã€‚</td>
</tr>
<tr>
<td><strong>sbh</strong></td>
<td><code>******</code></td>
<td>çŠ¶æ€æ é«˜åº¦ (Status Bar Height)ã€‚</td>
</tr>
<tr>
<td><strong>sys</strong></td>
<td><code>******</code></td>
<td>ç³»ç»Ÿç‰ˆæœ¬åç§°ã€‚</td>
</tr>
<tr>
<td><strong>ver</strong></td>
<td><code>******</code></td>
<td>App å¤§ç‰ˆæœ¬å·ã€‚</td>
</tr>
</tbody></table>
<hr>
<p><strong>ç¬¬ä¸‰éƒ¨åˆ†ï¼šä¸šåŠ¡ä¸è¯·æ±‚å‚æ•° (Business Logic)</strong></p>
<p>è¿™äº›å‚æ•°éšç”¨æˆ·çš„å…·ä½“æ“ä½œï¼ˆå¦‚åˆ·æ–°é¦–é¡µï¼‰è€Œå˜åŒ–ã€‚</p>
<table>
<thead>
<tr>
<th><strong>Key</strong></th>
<th><strong>Value</strong></th>
<th><strong>è¯´æ˜</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>bottom_navigation</strong></td>
<td><code>******</code></td>
<td>æ˜¯å¦æ˜¾ç¤ºåº•éƒ¨å¯¼èˆªæ ã€‚</td>
</tr>
<tr>
<td><strong>browseType</strong></td>
<td><code>******</code></td>
<td>æµè§ˆç±»å‹ (4 å¯èƒ½æŒ‡æ¨èæµ&#x2F;å‘ç°é¡µ)ã€‚</td>
</tr>
<tr>
<td><strong>clientRealReportData</strong></td>
<td><code>******</code></td>
<td>å®¢æˆ·ç«¯å®æ—¶ä¸ŠæŠ¥æ•°æ®å®¹å™¨ã€‚</td>
</tr>
<tr>
<td><strong>client_key</strong></td>
<td><code>******</code></td>
<td>å®¢æˆ·ç«¯å¯†é’¥&#x2F;æ ‡è¯†ã€‚</td>
</tr>
<tr>
<td><strong>cold</strong></td>
<td><code>******</code></td>
<td>æ˜¯å¦å†·å¯åŠ¨çŠ¶æ€ã€‚</td>
</tr>
<tr>
<td><strong>coldStart</strong></td>
<td><code>******</code></td>
<td>æ˜ç¡®çš„å†·å¯åŠ¨æ ‡è®°ã€‚</td>
</tr>
<tr>
<td><strong>cold_launch_time_ms</strong></td>
<td><code>******</code></td>
<td>å†·å¯åŠ¨æ—¶é—´æˆ³ã€‚</td>
</tr>
<tr>
<td><strong>count</strong></td>
<td><code>******</code></td>
<td>è¯·æ±‚è¿”å›çš„æ•°æ®æ¡æ•° (è¿™é‡ŒæŒ‡è¯·æ±‚ 6 ä¸ªè§†é¢‘)ã€‚</td>
</tr>
<tr>
<td><strong>edgeRecoBit</strong></td>
<td><code>******</code></td>
<td>è¾¹ç¼˜æ¨èç›¸å…³ä½æ ‡è¯†ã€‚</td>
</tr>
<tr>
<td><strong>edgeRerankConfigVersion</strong></td>
<td><code>******</code></td>
<td>è¾¹ç¼˜é‡æ’é…ç½®ç‰ˆæœ¬ã€‚</td>
</tr>
<tr>
<td><strong>ftt</strong></td>
<td><code>******</code></td>
<td>First Time Token æˆ–ç±»ä¼¼é¦–æ¬¡æ ‡è¯†ã€‚</td>
</tr>
<tr>
<td><strong>grant_browse_type</strong></td>
<td><code>******</code></td>
<td>æˆæƒæµè§ˆç±»å‹ (åˆå§‹åŒ–)ã€‚</td>
</tr>
<tr>
<td><strong>injectTask</strong></td>
<td><code>******</code></td>
<td>æ³¨å…¥ä»»åŠ¡æ ‡è¯†ã€‚</td>
</tr>
<tr>
<td><strong>isOpenAutoPlay</strong></td>
<td><code>******</code></td>
<td>æ˜¯å¦å¼€å¯è‡ªåŠ¨æ’­æ”¾ã€‚</td>
</tr>
<tr>
<td><strong>iuid</strong></td>
<td><code>******</code></td>
<td>å¯èƒ½æ˜¯ IMEI æˆ–å…¶ä»–ç”¨æˆ·å”¯ä¸€ IDã€‚</td>
</tr>
<tr>
<td><strong>kcv</strong></td>
<td><code>******</code></td>
<td>Key Config Version (é…ç½®ç‰ˆæœ¬)ã€‚</td>
</tr>
<tr>
<td><strong>nbh</strong></td>
<td><code>******</code></td>
<td>Navigation Bar Height (å¯¼èˆªæ é«˜åº¦)ã€‚</td>
</tr>
<tr>
<td><strong>newUserAction</strong></td>
<td><code>******</code></td>
<td><strong>JSONæ•°æ®</strong>ï¼šæ–°ç”¨æˆ·çš„äº¤äº’è¡Œä¸ºè®°å½•ï¼ˆç‚¹å‡»ã€å…³æ³¨ã€ç‚¹èµå‡ä¸ºç©ºï¼‰ã€‚</td>
</tr>
<tr>
<td><strong>newUserRefreshTimes</strong></td>
<td><code>******</code></td>
<td>æ–°ç”¨æˆ·åˆ·æ–°æ¬¡æ•°ã€‚</td>
</tr>
<tr>
<td><strong>page</strong></td>
<td><code>******</code></td>
<td>å½“å‰é¡µç ã€‚</td>
</tr>
<tr>
<td><strong>pcursor</strong></td>
<td><code>******</code></td>
<td>åˆ†é¡µæ¸¸æ ‡ (Page Cursor)ï¼Œé€šå¸¸é…åˆ feed æµä½¿ç”¨ã€‚</td>
</tr>
<tr>
<td><strong>pv</strong></td>
<td><code>******</code></td>
<td>Page View æ ‡è®°ã€‚</td>
</tr>
<tr>
<td><strong>realShowPhotoIds</strong></td>
<td><code>******</code></td>
<td>çœŸå®å±•ç¤ºè¿‡çš„è§†é¢‘ ID åˆ—è¡¨ (é€—å·åˆ†éš”)ï¼Œç”¨äºå»é‡ã€‚</td>
</tr>
<tr>
<td><strong>recoReportContext</strong></td>
<td><code>******</code></td>
<td><strong>JSONæ•°æ®</strong>ï¼šæ¨èä¸ŠæŠ¥ä¸Šä¸‹æ–‡ï¼ŒåŒ…å« GPS æƒé™ã€åˆ·æ–° IDã€ç”µæ± ç”µé‡ç­‰è¯¦ç»†ç¯å¢ƒä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td><strong>seid</strong></td>
<td><code>******</code></td>
<td>Session ID (ä¼šè¯ ID)ã€‚</td>
</tr>
<tr>
<td><strong>slh</strong></td>
<td><code>******</code></td>
<td>å¯èƒ½æŒ‡æœç´¢æ é«˜åº¦æˆ–å…¶ä»–å¸ƒå±€é«˜åº¦ã€‚</td>
</tr>
<tr>
<td><strong>source</strong></td>
<td><code>******</code></td>
<td>æ¥æºæ ‡è¯†ã€‚</td>
</tr>
<tr>
<td><strong>teenageAge</strong></td>
<td><code>******</code></td>
<td>é’å°‘å¹´æ¨¡å¼å¹´é¾„è®¾ç½®ã€‚</td>
</tr>
<tr>
<td><strong>uQaTag</strong></td>
<td><code>******</code></td>
<td>QA æµ‹è¯•æ ‡ç­¾ã€‚</td>
</tr>
<tr>
<td><strong>ud</strong></td>
<td><code>******</code></td>
<td>User Data æˆ–æŸç§ç”¨æˆ·çŠ¶æ€æ ‡è¯†ã€‚</td>
</tr>
<tr>
<td><strong>userRecoBit</strong></td>
<td><code>******</code></td>
<td>ç”¨æˆ·æ¨èä½æ ‡è¯†ã€‚</td>
</tr>
<tr>
<td><strong>videoModelCrowdTag</strong></td>
<td><code>******</code></td>
<td>è§†é¢‘æ¨¡å‹äººç¾¤æ ‡ç­¾ã€‚</td>
</tr>
</tbody></table>
<p>ç„¶åå°±æ˜¯ä¸€ä¸ªæ ‡å‡†MD5å°±èƒ½è·å–åˆ°<code>649xxxxx879d</code>ï¼ˆä¹‹æ‰€ä»¥è·Ÿç¬¬ä¸€æ¬¡çš„ä¸åŒæ˜¯å› ä¸ºè¿™ä¸æ˜¯åŒä¸€ä¸ªä¾‹å­ğŸ¤£ï¼‰</p>
<h3 id="sig3ä¼ å…¥"><a href="#sig3ä¼ å…¥" class="headerlink" title="sig3ä¼ å…¥"></a>sig3ä¼ å…¥</h3><p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224643.png" alt="image-20251216164501152"></p>
<p>ç¬¬ä¸€ä¸ªæ˜¯ç›‘æ§è®¡ç®—ç­¾åè€—æ—¶ï¼ˆå¯èƒ½ä¼šæ‹¿æ¥åšæ£€æµ‹ï¼Ÿï¼‰</p>
<p>ç¬¬äºŒä¸ªæ˜¯å…³é”®è®¡ç®—sig3å‡½æ•°</p>
<p>æœ€åèµ°çš„æ˜¯<code>com.kuaishou.android.security.internal.crypto.e.c</code>æ–¹æ³•ï¼Œä½†æ˜¯ä»jadxçœ‹è¯¥javaå±‚ä»£ç è¢«ä¸¥é‡æ··æ·†ï¼Œjadxæ— æ³•æ­£ç¡®åæ±‡ç¼–ï¼Œå› æ­¤ç›´æ¥é˜…è¯»smali</p>
<p>é€šè¿‡geminiå¯ä»¥åˆæ­¥æ¢å¤æˆï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> String <span class="title function_">c</span><span class="params">(String str, <span class="type">boolean</span> z, String str2)</span> <span class="keyword">throws</span> KSException &#123;</span><br><span class="line">    <span class="comment">// 1. çƒ­ä¿®å¤æ£€æŸ¥ (PatchProxy) - Smali å¼€å¤´éƒ¨åˆ†</span></span><br><span class="line">    <span class="keyword">if</span> (PatchProxy.isSupport(e.class)) &#123;</span><br><span class="line">        <span class="keyword">return</span> PatchProxy.accessDispatch(...);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 2. æ„é€ è¯·æ±‚å¯¹è±¡ (Request Builder)</span></span><br><span class="line">        <span class="comment">// å¯¹åº” Smali: Lcom/kuaishou/android/security/internal/plugin/n;-&gt;b()</span></span><br><span class="line">        n.<span class="type">a</span> <span class="variable">builder</span> <span class="operator">=</span> n.b();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è®¾ç½® AppKey, Map, Int ç­‰åŸºç¡€å‚æ•°</span></span><br><span class="line">        builder.a(b.i().j().a())</span><br><span class="line">               .a((Map) <span class="literal">null</span>)</span><br><span class="line">               .b(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®¾ç½®ä¼ å…¥çš„å‚æ•° z å’Œ str2</span></span><br><span class="line">        builder.a(z);       <span class="comment">// å¯¹åº” p2</span></span><br><span class="line">        builder.e(str2);    <span class="comment">// å¯¹åº” p3</span></span><br><span class="line">        builder.b(<span class="string">&quot;&quot;</span>);      <span class="comment">// è®¾ç½®æŸä¸ªé»˜è®¤ä¸ºç©ºçš„å­—æ®µ</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// ã€å…³é”®ã€‘å°†è¾“å…¥çš„ str è½¬ä¸º byte[] æ”¾å…¥è¯·æ±‚å¯¹è±¡</span></span><br><span class="line">        <span class="comment">// å¯¹åº” Smali: getBytes(&quot;UTF-8&quot;)</span></span><br><span class="line">        <span class="type">byte</span>[] strBytes = str.getBytes(Charset.forName(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        builder.a(strBytes);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ„å»ºæœ€ç»ˆè¯·æ±‚å¯¹è±¡ n</span></span><br><span class="line">        <span class="type">n</span> <span class="variable">requestObj</span> <span class="operator">=</span> builder.a();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3. è·å–æ’ä»¶æ¥å£ (Plugin Interface)</span></span><br><span class="line">        <span class="comment">// å¯¹åº” Smali: Lcom/kuaishou/android/security/internal/plugin/bundle/d;</span></span><br><span class="line">        <span class="type">e</span> <span class="variable">dispatch</span> <span class="operator">=</span> e.a(<span class="built_in">this</span>.context);</span><br><span class="line">        <span class="type">d</span> <span class="variable">pluginInterface</span> <span class="operator">=</span> dispatch.g(); </span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (pluginInterface == <span class="literal">null</span>) &#123;</span><br><span class="line">             <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">KSException</span>(<span class="string">&quot;SecurityGuardManager... return null&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4. ã€æ ¸å¿ƒè°ƒç”¨ã€‘ è°ƒç”¨æ¥å£æ–¹æ³• fï¼Œä¼ å…¥å‘½ä»¤å­— &quot;0335&quot;</span></span><br><span class="line">        <span class="comment">// å¯¹åº” Smali: const-string v0, &quot;0335&quot;</span></span><br><span class="line">        <span class="comment">// invoke-interface &#123;p3, p1, v0&#125;, ...-&gt;f(L.../n;Ljava/lang/String;)Z</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">success</span> <span class="operator">=</span> pluginInterface.f(requestObj, <span class="string">&quot;0335&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 5. ç¬¬ä¸€æ¬¡å°è¯•è·å–ç»“æœ</span></span><br><span class="line">        <span class="keyword">if</span> (success &amp;&amp; requestObj.g() != <span class="literal">null</span> &amp;&amp; requestObj.g().a().length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// æˆåŠŸï¼Œè·³è½¬åˆ°è¿”å›é€»è¾‘</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å¤±è´¥ï¼Œè®°å½•æ—¥å¿— &quot;signPlus return enull&quot;</span></span><br><span class="line">            <span class="comment">// 6. ã€é‡è¯•é€»è¾‘ã€‘ å†æ¬¡è°ƒç”¨ä¸€æ¬¡ f</span></span><br><span class="line">            success = pluginInterface.f(requestObj, <span class="string">&quot;0335&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 7. å¤„ç†æœ€ç»ˆç»“æœ</span></span><br><span class="line">        <span class="keyword">if</span> (success &amp;&amp; requestObj.g() != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">byte</span>[] resultBytes = requestObj.g().a();</span><br><span class="line">            <span class="keyword">if</span> (resultBytes.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// å°†ç»“æœå­—èŠ‚æ•°ç»„è½¬å› String è¿”å›</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">resultStr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(resultBytes);</span><br><span class="line">                <span class="keyword">return</span> resultStr;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// å¤±è´¥æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">KSException</span>(<span class="string">&quot;signPlus return enull final&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="comment">// å¼‚å¸¸ä¸ŠæŠ¥é€»è¾‘...</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">KSException</span>(...);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">invoke-interface &#123;p3, p1, v0&#125;, Lcom/kuaishou/android/security/internal/plugin/bundle/d;-&gt;f(Lcom/kuaishou/android/security/internal/plugin/n;Ljava/lang/String;)Z</span><br></pre></td></tr></table></figure>

<p>ç»è¿‡åˆ†æè°ƒç”¨çš„æ˜¯<code>com.kuaishou.android.security.internal.crypto.j.f</code>æ–¹æ³•ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">j.f is called: nVar=SecurityGuardParamContext&#123;paramMap=<span class="literal">null</span>, appKey=d7b7d042-d4f2-<span class="number">4012</span>-be60-d97ff2429c17, requestType=<span class="number">0</span>, reserved1=<span class="literal">null</span>, reserved2=<span class="literal">null</span>, input=[<span class="number">47</span>, <span class="number">114</span>, <span class="number">101</span>, <span class="number">115</span>, xxxxQwQxxxx ,<span class="number">99</span>, <span class="number">101</span>, <span class="number">52</span>, <span class="number">101</span>, <span class="number">99</span>, <span class="number">100</span>, <span class="number">49</span>, <span class="number">102</span>, <span class="number">97</span>, <span class="number">100</span>, <span class="number">48</span>, <span class="number">51</span>, <span class="number">99</span>], output=com.kuaishou.android.security.internal.plugin.n$b<span class="meta">@fd4eede</span>, errorCode=<span class="number">0</span>, privateKey=[], sdkId=, isInnerInvoke=<span class="literal">false</span>, did=&#125;, str=<span class="number">0335</span></span><br><span class="line">j.f result=<span class="literal">true</span></span><br></pre></td></tr></table></figure>



<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224644.png" alt="image-20251216164543778"></p>
<p>æœ€åèµ°åˆ°äº†è¿™ä¸ªå‡½æ•°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">native</span> Object <span class="title function_">doCommandNative</span><span class="params">(<span class="type">int</span> i4, Object[] objArr)</span>;</span><br></pre></td></tr></table></figure>

<p>æ˜¯ä¸€ä¸ªsoå±‚å®ç°çš„å‡½æ•°</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[com.kuaishou.android.security.internal.plugin.k.a]k.a is called: i4=<span class="number">10418</span>, objArr=[Ljava.lang.String;@8d18d16,d7b7d042-d4f2-<span class="number">4012</span>-be60-d97ff2429c17,-<span class="number">1</span>,<span class="literal">false</span>,com.yxcorp.gifshow.App@9da18de,,<span class="literal">false</span>,</span><br><span class="line">[com.kuaishou.android.security.internal.plugin.k.a]k.a result=5c4d3d1xxxxxe81366709050b1d</span><br></pre></td></tr></table></figure>

<p>å¿«æ‰‹é‡‡ç”¨äº†éå¸¸ç»å…¸çš„â€œé€šç”¨åˆ†å‘â€æ¨¡å¼ã€‚å®ƒæ²¡æœ‰ä¸ºæ¯ä¸ªåŠŸèƒ½å†™ä¸€ä¸ª JNI å‡½æ•°</p>
<p>è€Œæ˜¯å†™äº†ä¸€ä¸ªé€šç”¨çš„ <code>doCommandNative</code>ï¼Œé€šè¿‡æ•´æ•° ID (<code>i4</code>) æ¥åŒºåˆ†è¦æ‰§è¡Œä»€ä¹ˆåŠŸèƒ½</p>
<p><code>Ljava.lang.String;@8d18d16</code>è¿™é‡Œå­˜å‚¨äº†å¤„ç†è¿‡çš„å­—ç¬¦ä¸²MD5(sig)</p>
<p><code>d7b7d042-d4f2-4012-be60-d97ff2429c17</code>æ˜¯å¿«æ‰‹AppKey</p>
<p><code>com.yxcorp.gifshow.App@9da18de</code>ä¸ºNativeå±‚ç•™ä¸€ä¸ªè°ƒç”¨Javaæ–¹æ³•çš„å¯¹è±¡</p>
<h2 id="Nativeå±‚æµ…æ"><a href="#Nativeå±‚æµ…æ" class="headerlink" title="Nativeå±‚æµ…æ"></a>Nativeå±‚æµ…æ</h2><h3 id="å…¥å£"><a href="#å…¥å£" class="headerlink" title="å…¥å£"></a>å…¥å£</h3><p>Hook registerNativeå‡½æ•°è·å–</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[+] Captured RegisterNatives <span class="keyword">for</span>: com.kuaishou.android.security.internal.dispatch.JNICLibrary</span><br><span class="line">    Method count: <span class="number">5</span></span><br><span class="line">    -----------------------------------------</span><br><span class="line">    [TARGET FOUND] Method: doCommandNative</span><br><span class="line">    Signature: (I[Ljava/lang/Object;)Ljava/lang/Object;</span><br><span class="line">    Absolute Address: <span class="number">0x75f4981680</span></span><br><span class="line">    Module: libkwsgmain.so</span><br><span class="line">    Base Address: <span class="number">0x75f4940000</span></span><br><span class="line">    !!! OFFSET: <span class="number">0x41680</span> !!!</span><br><span class="line">    -----------------------------------------</span><br></pre></td></tr></table></figure>

<p>åœ¨<code>libkwsgmain.so</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224645.png" alt="image-20251211163631717"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">jint <span class="title">JNI_OnLoad</span><span class="params">(JavaVM *vm, <span class="type">void</span> *reserved)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">JUMPOUT</span>(<span class="number">0x4631C</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶å®å°±æ˜¯ä¸€ä¸ªgotoæŒ‡ä»¤ï¼Œç›´æ¥patch <code>BR X9</code>-&gt; <code>B 0x4631C</code>ï¼ŒIDAå°±ä¼šè‡ªå·±ç”Ÿæˆä¸€ä¸ª<code>sub_4631C</code>å‡½æ•°</p>
<blockquote>
<p>è¯¥è½¯ä»¶çš„èŠ±æŒ‡ä»¤åŸºæœ¬éƒ½æ˜¯è¿™ä¸ªï¼Œéå¸¸ç®€å•ï¼Œåªéœ€è¦patchä¸€ä¸ªæŒ‡ä»¤å³å¯ï¼Œå¯ä»¥å†™ä¸ªè„šæœ¬æ‰¹é‡åŒ¹é…ç‰¹å¾å€¼è¿›è¡Œpatchï¼Œä½†æ˜¯æˆ‘æ‡’ï¼Œæ‰€ä»¥éƒ½æ˜¯æ‰‹åŠ¨patch</p>
</blockquote>
<p>å­—ç¬¦ä¸²æ²¡æ‰¾åˆ°ä½†æ˜¯å¯ä»¥é€šè¿‡Hookçš„ç»“æœç›´æ¥å¾—çŸ¥å¯¹åº”å‡½æ•°æ˜¯<code>sub_41680</code></p>
<p>å…ˆunidbgæ­æ¶å­ï¼ŒæŠŠå‡½æ•°è¿è¡Œèµ·æ¥å…ˆ</p>
<p>unidbgéƒ¨åˆ†åœ¨ç½‘ä¸Šå°±å¾ˆå¤šäº†ï¼ŒåŸºæœ¬æ‹¿æ¥éƒ½èƒ½ç›´æ¥ç”¨ï¼Œè¿™é‡Œå°±ä¸è´´äº†</p>
<p>64ä½æƒ³æ­£å¸¸è¿è¡Œreadéœ€è¦å°†</p>
<p>unidbg-android&#x2F;src&#x2F;main&#x2F;java&#x2F;com&#x2F;github&#x2F;unidbg&#x2F;virtualmodule&#x2F;android&#x2F;AndroidModule.java</p>
<p>é‡Œçš„<code>throw new BackendException();</code>æ”¹ä¸º<code>return read(emulator, vm);</code>æ‰å¯ä»¥æ­£å¸¸è¿è¡Œ</p>
<p>å‘ç°å¤šæ¬¡è¿è¡Œç›¸åŒçš„å‚æ•°ç»“æœå´ä¸ç›¸åŒï¼ŒçŒœæµ‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­è°ƒç”¨äº†è·å–æ—¶é—´æˆ³çš„å‡½æ•°ï¼Œå¢åŠ äº†éšæœºæ€§ï¼Œåœ¨åˆ†æä¹‹å‰éœ€è¦å…ˆå›ºå®šéšæœº</p>
<p>ä¿®æ”¹gettimeofday64</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="type">long</span> <span class="title function_">currentTimeMillis</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1960949932368L</span>;<span class="comment">//System.currentTimeMillis();</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·æ¯æ¬¡è¿è¡Œçš„ç»“æœéƒ½æ˜¯<code>c5d4a4xxxxxxxxx77e3909c9284</code></p>
<h3 id="unidbgé…åˆé™æ€åˆ†æ"><a href="#unidbgé…åˆé™æ€åˆ†æ" class="headerlink" title="unidbgé…åˆé™æ€åˆ†æ"></a>unidbgé…åˆé™æ€åˆ†æ</h3><p>ç›®æ ‡å‡½æ•°å­˜åœ¨å¤§é‡ollvmæ··æ·†çš„ä»£ç ï¼ŒD-810è²Œä¼¼æœ‰ç‚¹bugï¼Œæ‰€ä»¥æˆ‘å†™äº†ä¸€ä¸ªé…åˆunidbgæ¨¡æ‹Ÿæ‰§è¡Œç„¶ånopæ‰ä¸€äº›æ— ç”¨é€»è¾‘çš„IDAæ’ä»¶</p>
<p><a target="_blank" rel="noopener" href="https://github.com/s1nec-1o/TraceClean">https://github.com/s1nec-1o/TraceClean</a></p>
<p>å¦‚æœæœ‰ç”¨ï¼Œçƒçƒstarâ­</p>
<p><code>sub_11BDC</code>å‡½æ•°</p>
<p>è°ƒç”¨å‰ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x0=<span class="number">0x404d80e0</span> x1=<span class="number">0x404d3240</span> x2=<span class="number">0x30</span> x3=<span class="number">0xbffff528</span> x4=<span class="number">0xbffff540</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">&gt;-----------------------------------------------------------------------------&lt;</span><br><span class="line">[<span class="number">19</span>:<span class="number">44</span>:<span class="number">54</span> <span class="number">838</span>]x0=RW@<span class="number">0x404d80e0</span>, md5=<span class="number">388</span>eb550700dae4d7b8c77fce6fd7868, hex=d8fd06400000000050f6ffbf0000000090f5ffbf00000000670000000000000041000000000000003600000000000000404e4e40000000000000000000000000380307400000000050904d4000000000e0814d400000000000824d4000000000d80207400000000080404e4000000000</span><br><span class="line">size: <span class="number">112</span></span><br><span class="line"><span class="number">0000</span>: D8 FD <span class="number">06</span> <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">50</span> F6 FF BF <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    ...@....P.......</span><br><span class="line"><span class="number">0010</span>: <span class="number">90</span> F5 FF BF <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">67</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    ........g.......</span><br><span class="line"><span class="number">0020</span>: <span class="number">41</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">36</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    A......<span class="number">.6</span>.......</span><br><span class="line"><span class="number">0030</span>: <span class="number">40</span> <span class="number">4</span>E <span class="number">4</span>E <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    @NN@............</span><br><span class="line"><span class="number">0040</span>: <span class="number">38</span> <span class="number">03</span> <span class="number">07</span> <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">50</span> <span class="number">90</span> <span class="number">4</span>D <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    <span class="number">8.</span>.@....P.M@....</span><br><span class="line"><span class="number">0050</span>: E0 <span class="number">81</span> <span class="number">4</span>D <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">82</span> <span class="number">4</span>D <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    ..M@......M@....</span><br><span class="line"><span class="number">0060</span>: D8 <span class="number">02</span> <span class="number">07</span> <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">80</span> <span class="number">40</span> <span class="number">4</span>E <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    ...@.....@N@....</span><br><span class="line">^-----------------------------------------------------------------------------^</span><br><span class="line"></span><br><span class="line">&gt;-----------------------------------------------------------------------------&lt;</span><br><span class="line">[<span class="number">19</span>:<span class="number">46</span>:<span class="number">25</span> <span class="number">591</span>]RW@<span class="number">0x404e4e40</span>, md5=bd4xxxx4102fcf47, hex=<span class="number">2f</span>7265xxxx65637xxxxx4343634623738xxxx000000000000000xxxx33930396339323834</span><br><span class="line">size: <span class="number">112</span></span><br><span class="line"><span class="number">0000</span>: <span class="number">2F</span> <span class="number">72</span> <span class="number">65</span> <span class="number">73</span> <span class="number">74</span> <span class="number">2F</span> <span class="number">6</span>E <span class="number">2F</span> <span class="number">66</span> <span class="number">65</span> <span class="number">65</span> <span class="number">64</span> <span class="number">2F</span> <span class="number">73</span> <span class="number">65</span> <span class="number">6</span>C    /rest/n/feed/sel</span><br><span class="line">xxx</span><br><span class="line"><span class="number">0030</span>: <span class="number">32</span> <span class="number">37</span> <span class="number">62</span> <span class="number">61</span> <span class="number">32</span> <span class="number">37</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    <span class="number">27b</span>a27..........</span><br><span class="line"><span class="number">0040</span>: <span class="number">63</span> <span class="number">35</span> <span class="number">64</span> <span class="number">34</span> <span class="number">61</span> <span class="number">34</span> <span class="number">38</span> <span class="number">37</span> <span class="number">39</span> <span class="number">64</span> <span class="number">33</span> <span class="number">34</span> <span class="number">32</span> <span class="number">63</span> <span class="number">66</span> <span class="number">63</span>    c5d4a4879d342cfc</span><br><span class="line">xxx</span><br><span class="line"><span class="number">0060</span>: <span class="number">33</span> <span class="number">38</span> <span class="number">32</span> <span class="number">64</span> <span class="number">37</span> <span class="number">37</span> <span class="number">65</span> <span class="number">33</span> <span class="number">39</span> <span class="number">30</span> <span class="number">39</span> <span class="number">63</span> <span class="number">39</span> <span class="number">32</span> <span class="number">38</span> <span class="number">34</span>    <span class="number">382</span>d77e3909c9284</span><br><span class="line">^-----------------------------------------------------------------------------^</span><br><span class="line">    </span><br><span class="line">&gt;-----------------------------------------------------------------------------&lt;</span><br><span class="line">[<span class="number">19</span>:<span class="number">45</span>:<span class="number">00</span> <span class="number">748</span>]x1=RW@<span class="number">0x404d3240</span>, md5=<span class="number">27b</span>xxxxxxf6de3, hex=<span class="number">63356</span>xxxxxx43865386637323965383736663338326437376533393039633932383430663933386334663039393561383363396266333166306336343332323538390000000000000000000000000000000034623462383431373330666131313837</span><br><span class="line">size: <span class="number">112</span></span><br><span class="line"><span class="number">0000</span>: <span class="number">63</span> <span class="number">35</span> <span class="number">64</span> <span class="number">34</span> <span class="number">61</span> <span class="number">34</span> <span class="number">38</span> <span class="number">37</span> <span class="number">39</span> <span class="number">64</span> <span class="number">33</span> <span class="number">34</span> <span class="number">32</span> <span class="number">63</span> <span class="number">66</span> <span class="number">63</span>    c5d4a4879d342cfc</span><br><span class="line">xxxxx</span><br><span class="line"><span class="number">0040</span>: <span class="number">39</span> <span class="number">62</span> <span class="number">66</span> <span class="number">33</span> <span class="number">31</span> <span class="number">66</span> <span class="number">30</span> <span class="number">63</span> <span class="number">36</span> <span class="number">34</span> <span class="number">33</span> <span class="number">32</span> <span class="number">32</span> <span class="number">35</span> <span class="number">38</span> <span class="number">39</span>    <span class="number">9b</span>f31f0c64322589</span><br><span class="line"><span class="number">0050</span>: <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    ................</span><br><span class="line"><span class="number">0060</span>: <span class="number">34</span> <span class="number">62</span> <span class="number">34</span> <span class="number">62</span> <span class="number">38</span> <span class="number">34</span> <span class="number">31</span> <span class="number">37</span> <span class="number">33</span> <span class="number">30</span> <span class="number">66</span> <span class="number">61</span> <span class="number">31</span> <span class="number">31</span> <span class="number">38</span> <span class="number">37</span>    <span class="number">4b</span>4b841730fa1187</span><br><span class="line">^-----------------------------------------------------------------------------^</span><br><span class="line"></span><br><span class="line">&gt;-----------------------------------------------------------------------------&lt;</span><br><span class="line">[<span class="number">19</span>:<span class="number">45</span>:<span class="number">11</span> <span class="number">154</span>]x3=unidbg@<span class="number">0xbffff528</span>, md5=<span class="number">6b</span>63f389a162b301ff80879932d5cf04, hex=b2cbbfab951b87030ee89e8c9d6e9a5fec65610e885c1f09010000000300000000000000040000000000000000000000002007400000000000200740000000003c0000000000000000404e400000000000000000000000000000000000000000000000000000000000cf0700eec9b64f</span><br><span class="line">size: <span class="number">112</span></span><br><span class="line"><span class="number">0000</span>: B2 CB BF AB <span class="number">95</span> <span class="number">1B</span> <span class="number">87</span> <span class="number">03</span> <span class="number">0</span>E E8 <span class="number">9</span>E <span class="number">8</span>C <span class="number">9</span>D <span class="number">6</span>E <span class="number">9</span>A <span class="number">5F</span>    .............n._</span><br><span class="line"><span class="number">0010</span>: EC <span class="number">65</span> <span class="number">61</span> <span class="number">0</span>E <span class="number">88</span> <span class="number">5</span>C <span class="number">1F</span> <span class="number">09</span> <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">03</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    .ea..\..........</span><br><span class="line"><span class="number">0020</span>: <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">04</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    ................</span><br><span class="line"><span class="number">0030</span>: <span class="number">00</span> <span class="number">20</span> <span class="number">07</span> <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">20</span> <span class="number">07</span> <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    . .@..... .@....</span><br><span class="line"><span class="number">0040</span>: <span class="number">3</span>C <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">40</span> <span class="number">4</span>E <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    &lt;........@N@....</span><br><span class="line"><span class="number">0050</span>: <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    ................</span><br><span class="line"><span class="number">0060</span>: <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> CF <span class="number">07</span> <span class="number">00</span> EE C9 B6 <span class="number">4F</span>    ...............O</span><br><span class="line">^-----------------------------------------------------------------------------^</span><br><span class="line"></span><br><span class="line">&gt;-----------------------------------------------------------------------------&lt;</span><br><span class="line">[<span class="number">19</span>:<span class="number">45</span>:<span class="number">13</span> <span class="number">548</span>]x4=unidbg@<span class="number">0xbffff540</span>, md5=<span class="number">3e1</span>e49c8021db65491c22c54bd370bb3, hex=<span class="number">010000000300000000000000040000000000000000000000002007400000000000200740000000003</span>c0000000000000000404e400000000000000000000000000000000000000000000000000000000000cf0700eec9b64f220000000000000000f6ffbf000000003100000000000000</span><br><span class="line">size: <span class="number">112</span></span><br><span class="line"><span class="number">0000</span>: <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">03</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">04</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    ................</span><br><span class="line"><span class="number">0010</span>: <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">20</span> <span class="number">07</span> <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    ......... .@....</span><br><span class="line"><span class="number">0020</span>: <span class="number">00</span> <span class="number">20</span> <span class="number">07</span> <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">3</span>C <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    . .@....&lt;.......</span><br><span class="line"><span class="number">0030</span>: <span class="number">00</span> <span class="number">40</span> <span class="number">4</span>E <span class="number">40</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    .@N@............</span><br><span class="line"><span class="number">0040</span>: <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    ................</span><br><span class="line"><span class="number">0050</span>: <span class="number">00</span> CF <span class="number">07</span> <span class="number">00</span> EE C9 B6 <span class="number">4F</span> <span class="number">22</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    .......O<span class="string">&quot;.......</span></span><br><span class="line"><span class="string">0060: 00 F6 FF BF 00 00 00 00 31 00 00 00 00 00 00 00    ........1.......</span></span><br><span class="line"><span class="string">^-----------------------------------------------------------------------------^</span></span><br></pre></td></tr></table></figure>

<p>è°ƒç”¨åï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt;-----------------------------------------------------------------------------&lt;</span><br><span class="line">[<span class="number">19</span>:<span class="number">47</span>:<span class="number">13</span> <span class="number">553</span>]x0=RW@<span class="number">0x404d3300</span>, md5=<span class="number">6f</span>c600b2f4392f46ab880d69b03eb31f, hex=<span class="number">6335</span>xxxxx6438653866xxxxx37376533393039633932383400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span><br><span class="line">size: <span class="number">112</span></span><br><span class="line"><span class="number">0000</span>: <span class="number">63</span> <span class="number">35</span> <span class="number">64</span> <span class="number">34</span> <span class="number">61</span> <span class="number">34</span> <span class="number">38</span> <span class="number">37</span> <span class="number">39</span> <span class="number">64</span> <span class="number">33</span> <span class="number">34</span> <span class="number">32</span> <span class="number">63</span> <span class="number">66</span> <span class="number">63</span>    c5d4a4879d342cfc</span><br><span class="line">xxxxx</span><br><span class="line"><span class="number">0020</span>: <span class="number">33</span> <span class="number">38</span> <span class="number">32</span> <span class="number">64</span> <span class="number">37</span> <span class="number">37</span> <span class="number">65</span> <span class="number">33</span> <span class="number">39</span> <span class="number">30</span> <span class="number">39</span> <span class="number">63</span> <span class="number">39</span> <span class="number">32</span> <span class="number">38</span> <span class="number">34</span>    <span class="number">382</span>d77e3909c9284</span><br><span class="line"><span class="number">0030</span>: <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    ................</span><br><span class="line"><span class="number">0040</span>: <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    ................</span><br><span class="line"><span class="number">0050</span>: <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    ................</span><br><span class="line"><span class="number">0060</span>: <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span>    ................</span><br><span class="line">^-----------------------------------------------------------------------------^</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°ç”šè‡³åœ¨è°ƒç”¨è¿™ä¸ªå‡½æ•°ä¹‹å‰å°±å·²ç»å­˜åœ¨ç»“æœäº†ï¼Œé‚£ä¹ˆè‚¯å®šåœ¨ä¹‹å‰å°±æœ‰èµ‹å€¼æ“ä½œäº†ï¼</p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224646.png" alt="image-20251214201659299"></p>
<p>ä¼šå‘ç°å…¶å®å°±æ˜¯v100ï¼Œä½†æ˜¯v100æ²¡æœ‰ä»»ä½•ç›´æ¥èµ‹å€¼çš„æ“ä½œï¼</p>
<img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224647.png" alt="image-20251214201725361" style="zoom:50%;" />

<p>ç¬¬äºŒä¸ªæ˜¾ç„¶å°±ä¸å¯èƒ½ï¼Œç¬¬ä¸€ä¸ªå°±æ˜¯ä¹‹å‰çš„åŸè¯­ï¼</p>
<p>æˆ‘å¼€å§‹æ€€ç–‘æ˜¯ä¸æ˜¯æˆ‘æ’ä»¶çš„BUGäº†ï¼Ÿä½†æ˜¯è¿™ä¹ˆç®€å•çš„æ’ä»¶æ€ä¹ˆå¯èƒ½æœ‰é—®é¢˜å‘¢ï¼Œunidbgæ£€æµ‹ä¸€ä¸‹è¿™ä¸ªåœ°å€é™„è¿‘çš„å€¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emulator.traceWrite(<span class="number">0x404e4e80</span>,<span class="number">0x404e4e80</span>+<span class="number">0x30</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">483</span>] Memory WRITE at <span class="number">0x404e4e80</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x63</span>, PC=RX@<span class="number">0x40013bf0</span>[libkwsgmain.so]<span class="number">0x13bf0</span>, LR=RX@<span class="number">0x40013bd0</span>[libkwsgmain.so]<span class="number">0x13bd0</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">483</span>] Memory WRITE at <span class="number">0x404e4e81</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x35</span>, PC=RX@<span class="number">0x40013bf0</span>[libkwsgmain.so]<span class="number">0x13bf0</span>, LR=RX@<span class="number">0x40013bd0</span>[libkwsgmain.so]<span class="number">0x13bd0</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">483</span>] Memory WRITE at <span class="number">0x404e4e82</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x64</span>, PC=RX@<span class="number">0x40013bf0</span>[libkwsgmain.so]<span class="number">0x13bf0</span>, LR=RX@<span class="number">0x40013bd0</span>[libkwsgmain.so]<span class="number">0x13bd0</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">483</span>] Memory WRITE at <span class="number">0x404e4e83</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x34</span>, PC=RX@<span class="number">0x40013bf0</span>[libkwsgmain.so]<span class="number">0x13bf0</span>, LR=RX@<span class="number">0x40013bd0</span>[libkwsgmain.so]<span class="number">0x13bd0</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">483</span>] Memory WRITE at <span class="number">0x404e4e84</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x61</span>, PC=RX@<span class="number">0x40013bf0</span>[libkwsgmain.so]<span class="number">0x13bf0</span>, LR=RX@<span class="number">0x40013bd0</span>[libkwsgmain.so]<span class="number">0x13bd0</span></span><br><span class="line">xxxxxxx</span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">483</span>] Memory WRITE at <span class="number">0x404e4e8f</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x63</span>, PC=RX@<span class="number">0x40013bf0</span>[libkwsgmain.so]<span class="number">0x13bf0</span>, LR=RX@<span class="number">0x40013bd0</span>[libkwsgmain.so]<span class="number">0x13bd0</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">483</span>] Memory WRITE at <span class="number">0x404e4e90</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x38</span>, PC=RX@<span class="number">0x40013bf0</span>[libkwsgmain.so]<span class="number">0x13bf0</span>, LR=RX@<span class="number">0x40013bd0</span>[libkwsgmain.so]<span class="number">0x13bd0</span></span><br><span class="line">xxxxxx</span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">483</span>] Memory WRITE at <span class="number">0x404e4e96</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x38</span>, PC=RX@<span class="number">0x40013bf0</span>[libkwsgmain.so]<span class="number">0x13bf0</span>, LR=RX@<span class="number">0x40013bd0</span>[libkwsgmain.so]<span class="number">0x13bd0</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">483</span>] Memory WRITE at <span class="number">0x404e4e97</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x66</span>, PC=RX@<span class="number">0x40013bf0</span>[libkwsgmain.so]<span class="number">0x13bf0</span>, LR=RX@<span class="number">0x40013bd0</span>[libkwsgmain.so]<span class="number">0x13bd0</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">483</span>] Memory WRITE at <span class="number">0x404e4e98</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x37</span>, PC=RX@<span class="number">0x40013bf0</span>[libkwsgmain.so]<span class="number">0x13bf0</span>, LR=RX@<span class="number">0x40013bd0</span>[libkwsgmain.so]<span class="number">0x13bd0</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">483</span>] Memory WRITE at <span class="number">0x404e4e99</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x32</span>, PC=RX@<span class="number">0x40013bf0</span>[libkwsgmain.so]<span class="number">0x13bf0</span>, LR=RX@<span class="number">0x40013bd0</span>[libkwsgmain.so]<span class="number">0x13bd0</span></span><br><span class="line">xxxx</span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">484</span>] Memory WRITE at <span class="number">0x404e4ea5</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x37</span>, PC=RX@<span class="number">0x40013bf0</span>[libkwsgmain.so]<span class="number">0x13bf0</span>, LR=RX@<span class="number">0x40013bd0</span>[libkwsgmain.so]<span class="number">0x13bd0</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">484</span>] Memory WRITE at <span class="number">0x404e4ea6</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x65</span>, PC=RX@<span class="number">0x40013bf0</span>[libkwsgmain.so]<span class="number">0x13bf0</span>, LR=RX@<span class="number">0x40013bd0</span>[libkwsgmain.so]<span class="number">0x13bd0</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">484</span>] Memory WRITE at <span class="number">0x404e4ea7</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x33</span>, </span><br><span class="line">xxxx</span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">484</span>] Memory WRITE at <span class="number">0x404e4eaf</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x34</span>, PC=RX@<span class="number">0x40013bf0</span>[libkwsgmain.so]<span class="number">0x13bf0</span>, LR=RX@<span class="number">0x40013bd0</span>[libkwsgmain.so]<span class="number">0x13bd0</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">484</span>] Memory WRITE at <span class="number">0x404e4eb0</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x00</span>, PC=RX@<span class="number">0x40013c34</span>[libkwsgmain.so]<span class="number">0x13c34</span>, LR=RX@<span class="number">0x40013bd0</span>[libkwsgmain.so]<span class="number">0x13bd0</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">485</span>] Memory WRITE at <span class="number">0x404e4e80</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">8</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x3738346134643563</span>, PC=RX@<span class="number">0x401dc17c</span>[libc.so]<span class="number">0x1c17c</span>, LR=RX@<span class="number">0x4000d908</span>[libkwsgmain.so]<span class="number">0xd908</span></span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">485</span>] Memory WRITE at <span class="number">0x404e4e88</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">8</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x6366633234336439</span>, PC=RX@<span class="number">0x401dc17c</span>[libc.so]<span class="number">0x1c17c</span>,</span><br><span class="line">xxxxx</span><br><span class="line">[<span class="number">20</span>:<span class="number">12</span>:<span class="number">51</span> <span class="number">485</span>] Memory WRITE at <span class="number">0x404e4ea8</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">8</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x3438323963393039</span>, PC=RX@<span class="number">0x401dc18c</span>[libc.so]<span class="number">0x1c18c</span>, LR=RX@<span class="number">0x4000d908</span>[libkwsgmain.so]<span class="number">0xd908</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ ¹æ®è¿™ä¸ªtraceå¯ä»¥æ‰¾åˆ°è°ƒç”¨é€»è¾‘</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sub_A720-&gt;sub_1E5B8-&gt;sub_3D5F4-&gt;sub_13B1C</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­æœ‰å‡ ä¸ªå‡½æ•°çš„éƒ¨åˆ†å‡½æ•°è°ƒç”¨æ˜¯ä¸ä¼šè°ƒç”¨çš„ï¼Œç›´æ¥å¯ä»¥nop</p>
<p>å¤§è‡´çŸ¥é“è°ƒç”¨é¡ºåºäº†ï¼Œé‚£ä¹ˆå¼€å§‹åˆ†æå§ï¼Œä»å°¾å·´å¼€å§‹å¾€ä¸Šåˆ†æ</p>
<h3 id="HMAC-SHA256"><a href="#HMAC-SHA256" class="headerlink" title="HMAC-SHA256"></a>HMAC-SHA256</h3><p>sub_3D5F4<img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224648.png" alt="image-20251214224136911"></p>
<p>è¿™é‡Œçš„v31ååˆ†å¯ç–‘</p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224649.png" alt="image-20251214224228829"></p>
<p>æ˜¯é€šè¿‡23578çš„a2æ¥èµ‹å€¼</p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224650.png" alt="image-20251214224310065"></p>
<p>è¿™é‡Œä¼šå‘ç°è°ƒç”¨çš„æ˜¯ä¸‹é¢çš„ä¸¤ä¸ªå‡½æ•°</p>
<p>é€šè¿‡æ’ä»¶èƒ½é¦–å…ˆå‘ç°å…·æœ‰SHA256ç‰¹å¾ï¼Œå› æ­¤å°è¯•SHA256ï¼Œä½†ä¸ç»“æœå­˜åœ¨è¾ƒå¤§å·®å¼‚æ€§ï¼Œç„¶åå‘ç°è¿™ä¸ªå‡½æ•°å¤šä¼ å…¥äº†ä¸¤ä¸ªå¯ç–‘å‚æ•°ï¼Œç»è¿‡æ¯”å¯¹åˆ†æï¼Œå‘ç°æ˜¯HMACçš„æ€§èƒ½ä¼˜åŒ–çš„å®ç°ï¼Œä¸ºäº†é¿å…æ¯æ¬¡è®¡ç®—ç­¾åéƒ½é‡å¤è¿›è¡ŒKey ^ 0x36å’ŒKey ^ 0x5Cçš„è¿ç®—ï¼Œç¨‹åºé¢„å…ˆè®¡ç®—å¥½äº†è¿™ä¸¤ä¸ªçŠ¶æ€ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œç»è¿‡unidbgæ‰“å°å‡ºå¯¹åº”çš„å€¼å°±èƒ½çœ‹å‡ºæ¥ï¼Œå¯†é’¥ï¼š<code>vWqd4fRXxXxxxxxxxxxeRitxT7VwbK</code></p>
<p>ç„¶åå°±èƒ½å†™å‡ºä¸‹é¢çš„è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">secret_key = <span class="string">b&quot;vWqd4fRxxxxxxxitxT7VwbK&quot;</span></span><br><span class="line">data = <span class="string">b&quot;/rest/n/feed/selection62ccedxxxxxxba27&quot;</span></span><br><span class="line">signature = hmac.new(secret_key, data, hashlib.sha256).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Calculated: <span class="subst">&#123;signature&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">assert</span> signature == <span class="string">&quot;e46ed2xxxxxxxxxx52c08&quot;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä¸€èˆ¬æ¥è¯´å¦‚æœçœ‹åˆ°æ˜¯SHA256ä½†è¾“å‡ºå´ä¸æ˜¯æ ‡å‡†SHA256ï¼Œæœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p>
<ol>
<li>HMAC-SHA256ï¼ˆæ¦‚ç‡æœ€é«˜ï¼‰</li>
<li>è¾“å…¥è¢«åŠ Saltæˆ–è€…å¯¹è¾“å…¥è¿›è¡Œäº†é¢„å¤„ç†ï¼ˆå‰ååŠ Saltã€è½¬hexã€å¤§å°ç«¯ã€ç‰¹æ®Šå­—ç¬¦ï¼‰</li>
<li>é­”æ”¹åˆå§‹å‘é‡ï¼ˆæœ€å¥½åˆ¤æ–­ï¼‰</li>
<li>é­”æ”¹è½®å¸¸é‡ï¼ˆä¿®æ”¹Kè¡¨ï¼Œæ‰¾0x428A2F98æ‰¾ä¸åˆ°å°±æ˜¯Kè¡¨è¢«æ”¹äº†ï¼‰</li>
<li>é­”æ”¹é€»è¾‘&#x2F;ä½ç§»é‡ï¼ˆä¿®æ”¹Sigmaæˆ–Ch&#x2F;Majçš„ä½ç§»æ•°ï¼Œå¾ˆéš¾åˆ¤æ–­ï¼Œéœ€è¦ä¸€è¡Œä¸€è¡Œæ¯”å¯¹æ±‡ç¼–é€»è¾‘ï¼‰</li>
<li>è¾“å‡ºåå¤„ç†ï¼ˆtraceä¸€ä¸‹ï¼Œä¹Ÿå¥½åˆ¤æ–­ï¼‰</li>
<li>â€¦â€¦.</li>
</ol>
</blockquote>
<p>ç„¶åçœ‹åˆ°03D5F4å‡½æ•°</p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224651.png" alt="image-20251215143650309"></p>
<p>è¿™ä¸ªå‡½æ•°æ„Ÿè§‰å°±æ˜¯C++çš„æŸä¸ªåº“å‡½æ•°ï¼Œæ¶‰åŠåˆ°æµçš„æ“ä½œï¼Œä½†æ˜¯å…¶å®å°±æ˜¯ä¸€ä¸ªtoHexå‡½æ•°</p>
<p>å°†ç±»ä¼¼<code>0xC5-&gt;0x63 0x35</code></p>
<p>é€šè¿‡è·Ÿè¸ªtraceå‘ç°è¿™æ˜¯è¾ƒæ—©å‡ºç°ç»“æœçš„åœ°æ–¹</p>
<p>æ‰§è¡Œè¿‡ä¸‰æ¬¡è¿™ä¸ªtoHexå‡½æ•°ï¼Œç¬¬ä¸€æ¬¡æ˜¯HMAC-SHA256çš„å†™å…¥ï¼Œç¬¬äºŒæ¬¡ä¹Ÿæ˜¯æŸä¸ªç®—æ³•ï¼Œç¬¬ä¸‰æ¬¡å°±æ˜¯æœ€åçš„ç»“æœäº†ï¼Œä»æœ€åä¸€æ¬¡çœ‹</p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224652.png" alt="image-20251215144742653"></p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224653.png" alt="image-20251215144851860"></p>
<p>ä½†æ˜¯å‘ç°ç»“æœæ˜¯24ä½çš„æ˜¾ç„¶æ˜¯ä¸å¯¹çš„ï¼Œç»“æœåº”è¯¥æ˜¯48ä½æ‰å¯¹ï¼Œåº”è¯¥æ˜¯åé¢è¿˜æœ‰æ‹¼æ¥å§</p>
<p>ä¸è¿‡è¿™24ä½ç¡®å®æ˜¯ç»“æœ</p>
<h3 id="0"><a href="#0" class="headerlink" title="0:"></a>0:</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 *<span class="title">sub_2BD20</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">unsigned</span> __int8 v0; <span class="comment">// w8</span></span><br><span class="line"></span><br><span class="line">  v0 = <span class="built_in">atomic_load</span>((<span class="type">unsigned</span> __int8 *)&amp;byte_72808);</span><br><span class="line">  <span class="keyword">if</span> ( (v0 &amp; <span class="number">1</span>) == <span class="number">0</span> &amp;&amp; __cxa_guard_acquire((__guard *)&amp;byte_72808) )<span class="comment">// çº¿ç¨‹å®‰å…¨ï¼Œç¡®ä¿åªæ‰§è¡Œä¸€æ¬¡åˆå§‹åŒ–æ“ä½œ</span></span><br><span class="line">  &#123;</span><br><span class="line">    qword_727A0 = (__int64)&amp;off_702A8;</span><br><span class="line">    xmmword_727F8 = <span class="number">0u</span>;</span><br><span class="line">    xmmword_727E8 = <span class="number">0u</span>;</span><br><span class="line">    xmmword_727D8 = <span class="number">0u</span>;</span><br><span class="line">    xmmword_727C8 = <span class="number">0u</span>;</span><br><span class="line">    __cxa_atexit((<span class="built_in">void</span> (*)(<span class="type">void</span> *))&amp;sub_301A4, &amp;qword_727A0, &amp;off_71000);</span><br><span class="line">    __cxa_guard_release((__guard *)&amp;byte_72808);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &amp;qword_727A0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªå‡½æ•°æ˜¯å¯¹å…¨å±€thisæŒ‡é’ˆçš„åˆå§‹åŒ–ï¼Œå¹¶è¿”å›thisæŒ‡é’ˆï¼Œç»è¿‡traceå‘ç°è¿™é‡Œè¿”å›ç»“æœ[3]+8çš„å€¼éƒ½æ˜¯å›ºå®šçš„22</p>
<p>å› æ­¤0æ˜¯å›ºå®šçš„0x51412200</p>
<h3 id="1"><a href="#1" class="headerlink" title="1:"></a>1:</h3><p>è²Œä¼¼ä¹Ÿæ˜¯å›ºå®šçš„0x1db5ae7f</p>
<h3 id="3"><a href="#3" class="headerlink" title="3:"></a>3:</h3><h3 id="wbAES"><a href="#wbAES" class="headerlink" title="wbAES"></a>wbAES</h3><p>å…ˆdumpå‚æ•°</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x0=</span><br><span class="line">cab68c9xxxxxxxxxb3ebe0ed8ea4aab0c1d5f4519f8d19c4948f</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªx0æ˜¯ç¬¬äºŒæ¬¡toHexçš„å…¥å‚</p>
<p>x1æ˜¯<code>0x30</code>å°±æ˜¯len</p>
<p>x2æ˜¯<code>CRC32b_poly_Constant_57C78</code></p>
<p>é‚£å°±å…ˆçœ‹x0æ˜¯æ€ä¹ˆè·å–çš„</p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224654.png" alt="image-20251215155608558"></p>
<p>é€šè¿‡sub_1E2C4å‡½æ•°è·å–</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sub_26E44</span>(v20, *a1);</span><br><span class="line"><span class="built_in">sub_26A14</span>(v20, HMAC_SHA256_final_1_1, HMAC_SHA256_final_len, src, src_len);</span><br></pre></td></tr></table></figure>

<p>v20ä¾èµ–å…¨å±€å˜é‡ï¼Œç„¶åè°ƒç”¨26A14</p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224655.png" alt="image-20251215160747750"></p>
<p>æ‰€ä»¥v24å­˜å‚¨çš„å°±æ˜¯æˆ‘ä»¬åœ¨å¯»æ‰¾çš„å­—ç¬¦ä¸²ï¼Œç„¶åçœ‹åˆ°v24æ˜¯mallocå‡ºæ¥çš„å †å†…å­˜<code>0x404d3240</code>traceçœ‹çœ‹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">16</span>:<span class="number">15</span>:<span class="number">11</span> <span class="number">186</span>] Memory WRITE at <span class="number">0x404d3240</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0xca</span>, PC=RX@<span class="number">0x400265fc</span>[libkwsgmain.so]<span class="number">0x265fc</span>, LR=RX@<span class="number">0x4002646c</span>[libkwsgmain.so]<span class="number">0x2646c</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">15</span>:<span class="number">11</span> <span class="number">186</span>] Memory WRITE at <span class="number">0x404d3241</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0xb6</span>, PC=RX@<span class="number">0x400265fc</span>[libkwsgmain.so]<span class="number">0x265fc</span>, LR=RX@<span class="number">0x4002646c</span>[libkwsgmain.so]<span class="number">0x2646c</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">15</span>:<span class="number">11</span> <span class="number">186</span>] Memory WRITE at <span class="number">0x404d3242</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x8c</span>, PC=RX@<span class="number">0x400265fc</span>[libkwsgmain.so]<span class="number">0x265fc</span>, LR=RX@<span class="number">0x4002646c</span>[libkwsgmain.so]<span class="number">0x2646c</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">15</span>:<span class="number">11</span> <span class="number">186</span>] Memory WRITE at <span class="number">0x404d3243</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x9f</span>, PC=RX@<span class="number">0x400265fc</span>[libkwsgmain.so]<span class="number">0x265fc</span>, LR=RX@<span class="number">0x4002646c</span>[libkwsgmain.so]<span class="number">0x2646c</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">15</span>:<span class="number">11</span> <span class="number">186</span>] Memory WRITE at <span class="number">0x404d3244</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x78</span>, </span><br><span class="line">xxx </span><br><span class="line">PC=RX@<span class="number">0x400265fc</span>[libkwsgmain.so]<span class="number">0x265fc</span>, LR=RX@<span class="number">0x4002646c</span>[libkwsgmain.so]<span class="number">0x2646c</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">15</span>:<span class="number">11</span> <span class="number">188</span>] Memory WRITE at <span class="number">0x404d326e</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x94</span>, PC=RX@<span class="number">0x400265fc</span>[libkwsgmain.so]<span class="number">0x265fc</span>, LR=RX@<span class="number">0x4002646c</span>[libkwsgmain.so]<span class="number">0x2646c</span></span><br><span class="line">[<span class="number">16</span>:<span class="number">15</span>:<span class="number">11</span> <span class="number">188</span>] Memory WRITE at <span class="number">0x404d326f</span>, <span class="type">data</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="type">data</span> <span class="variable">value</span> <span class="operator">=</span> <span class="number">0x8f</span>, PC=RX@<span class="number">0x400265fc</span>[libkwsgmain.so]<span class="number">0x265fc</span>, LR=RX@<span class="number">0x4002646c</span>[libkwsgmain.so]<span class="number">0x2646c</span></span><br></pre></td></tr></table></figure>

<p>ä½äº2636Cå‡½æ•°ä¸­ï¼Œåˆæ­¥åˆ¤æ–­ä¸ºç™½ç›’AES</p>
<p>æ ¹æ®è°ƒè¯•å¯ä»¥çŸ¥é“å¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š</p>
<p>é¦–å…ˆåœ¨è¿›å…¥è¿™ä¸ªå‡½æ•°ä¹‹å‰ä¼šå°†HMAC-SHA256çš„ç»“æœè¿›è¡Œå¡«å……\x10åˆ°0x30ä¸ªå­—èŠ‚</p>
<p>ç„¶åæ¯0x10ä¸ªå­—èŠ‚è¿›å»è¿™ä¸ªå‡½æ•°ä¸€æ¬¡ï¼Œè¾“å‡º0x10ä¸ªå­—èŠ‚çš„å¯†æ–‡</p>
<p>ç®€å•è¡¥ä¸ªç¯å¢ƒ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">call_AES</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">hexInput</span> <span class="operator">=</span> <span class="string">&quot;E46ED2xxxxxxxxB349C97C5BF21F44519D2E6452C0810101010101010101010101010101010&quot;</span>;</span><br><span class="line">    <span class="type">byte</span>[] inputData = hexToByteArray(hexInput);</span><br><span class="line"></span><br><span class="line">    <span class="type">UnidbgPointer</span> <span class="variable">inputPtr</span> <span class="operator">=</span> emulator.getMemory().malloc(inputData.length, <span class="literal">true</span>).getPointer();</span><br><span class="line">    inputPtr.write(inputData);</span><br><span class="line"></span><br><span class="line">    <span class="type">UnidbgPointer</span> <span class="variable">outputPtr</span> <span class="operator">=</span> emulator.getMemory().malloc(inputData.length, <span class="literal">true</span>).getPointer();</span><br><span class="line"></span><br><span class="line">    <span class="type">UnidbgPointer</span> <span class="variable">arg1Ptr</span> <span class="operator">=</span> emulator.getMemory().malloc(<span class="number">16</span>, <span class="literal">true</span>).getPointer();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;=== å¼€å§‹åˆ†å—åŠ å¯† (3è½® x 16å­—èŠ‚) ===&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">offset</span> <span class="operator">=</span> i * <span class="number">16</span>; <span class="comment">// æ¯æ¬¡åç§» 0, 16, 32</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">module</span>.callFunction(emulator, <span class="number">0x2636C</span>,</span><br><span class="line">                arg1Ptr,                <span class="comment">// Arg1: å›ºå®š</span></span><br><span class="line">                inputPtr.share(offset), <span class="comment">// Arg2: è¾“å…¥æŒ‡é’ˆåç§»</span></span><br><span class="line">                outputPtr.share(offset) <span class="comment">// Arg3: è¾“å‡ºæŒ‡é’ˆåç§» (ç»“æœä¼šè‡ªåŠ¨æ‹¼æ¥)</span></span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;Full Ciphertext (Arg3):&quot;</span>);</span><br><span class="line">    Inspector.inspect(outputPtr.getByteArray(<span class="number">0</span>, inputData.length), <span class="string">&quot;AES Result&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] hexToByteArray(String hex) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> hex.length();</span><br><span class="line">    <span class="type">byte</span>[] data = <span class="keyword">new</span> <span class="title class_">byte</span>[len / <span class="number">2</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; len; i += <span class="number">2</span>) &#123;</span><br><span class="line">        data[i / <span class="number">2</span>] = (<span class="type">byte</span>) ((Character.digit(hex.charAt(i), <span class="number">16</span>) &lt;&lt; <span class="number">4</span>)</span><br><span class="line">                + Character.digit(hex.charAt(i+<span class="number">1</span>), <span class="number">16</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>$$<br>\begin{array}{l}\text{state} \leftarrow \text{plaintext} \\text{AddRoundKey}(\text{state}, k_0) \\text{for } r &#x3D; 1 \dots 9 \\quad \text{SubBytes}(\text{state}) \\quad \text{ShiftRows}(\text{state}) \\quad \text{MixColumns}(\text{state}) \\quad \text{AddRoundKey}(\text{state}, k_r) \\text{SubBytes}(\text{state}) \\text{ShiftRows}(\text{state}) \\text{AddRoundKey}(\text{state}, k_{10}) \\text{ciphertext} \leftarrow \text{state}\end{array}<br>$$</p>
<p>åˆ¤æ–­ç™½ç›’AES-128çš„é€»è¾‘å¦‚ä¸‹ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224656.png" alt="image-20251216122932442"></p>
<p>è¿™é‡Œæœ‰10è½®çš„å¾ªç¯ï¼Œç¬¦åˆAES-128çš„æ ‡å‡†è½®æ•°</p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224657.png" alt="image-20251216123106090"></p>
<p>çœ‹åˆ°v3ï¼Œç»è¿‡ç®€å•åˆ†æï¼Œå‘ç°ä¸»å¾ªç¯ä¸­æ˜¯4æ¬¡å¾ªç¯ï¼Œè€Œæˆ‘ä»¬è¾“å…¥çš„å­—èŠ‚æ•°æ˜¯0x10ï¼Œ4*4çŸ©é˜µï¼Œå¤„ç†4æ¬¡</p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224658.png" alt="image-20251216123228705"></p>
<p>è¿™ä¸ªå¾—è¯¦ç»†åˆ†æä¸€ä¸‹</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*((_BYTE *)a1 + v10) = v33[v23] | (<span class="number">0x10</span> * v32[v20]);</span><br><span class="line">*((_BYTE *)a1 + v9) = v27 | (<span class="number">16</span> * v21);</span><br><span class="line">*((_BYTE *)a1 + v8) = v16 | (<span class="number">16</span> * v15);</span><br><span class="line">v3 = v40 + <span class="number">1</span>;</span><br><span class="line">*((_BYTE *)a1 + v7) = v24 | (<span class="number">16</span> * v31);</span><br></pre></td></tr></table></figure>

<p>æœ€åç»“æœæ˜¯é€šè¿‡ä¸¤ä¸ªåŠå­—èŠ‚ä¹Ÿå°±æ˜¯ä¸€ä¸ªhexæ‹¼æ¥æˆä¸€ä¸ªå­—èŠ‚</p>
<p>å…¶ä¸­v33å’Œv32æ˜¯int8ç±»å‹ï¼Œä½†æ˜¯å‰é¢çš„é€»è¾‘ï¼Œå®ƒçš„å€¼åªä¼šåœ¨0x00-0x0Fï¼Œv27ç­‰è™½ç„¶æ˜¯int64ä½†åœ¨æ­¤ä¹‹å‰åšè¿‡LOBYTEå¤„ç†äº†ï¼ŒLOBYTEå°±æ˜¯BYTEçš„ä½ä½ï¼Œä¹Ÿå°±æ˜¯åŠä¸ªå­—èŠ‚</p>
<p>ç„¶åçœ‹åˆ°è¿™ä¸ª5AB70çš„è¡¨ï¼š</p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224659.png" alt="image-20251216131655788"></p>
<p>æ˜¾ç„¶è¿™æ˜¯ä¸€ä¸ªå¼‚æˆ–è¡¨ï¼Œå¯ä»¥å°†a ^ b è½¬æ¢æˆ ç¬¬aè¡Œçš„ç¬¬båˆ—çš„å€¼</p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224660.png" alt="image-20251216132125439"></p>
<p>å¯ä»¥æ©ç›–AESçš„xorç‰¹å¾</p>
<p>sub_25938é€šè¿‡unidbgæ‰§è¡Œå¯ä»¥ç¡®å®šï¼Œä¸€æ¬¡æ‰§è¡ŒAESæ‰§è¡Œäº†10æ¬¡ï¼Œç„¶åè¯¦ç»†åˆ†æå°±ç¡®å®šæ˜¯<strong>è¡Œç§»ä½</strong>äº†</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">long</span> <span class="type">double</span> __fastcall <span class="title">sub_25938</span><span class="params">(_OWORD *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// x9</span></span><br><span class="line">  <span class="type">long</span> <span class="type">double</span> result; <span class="comment">// q0</span></span><br><span class="line">  <span class="type">long</span> <span class="type">double</span> v3; <span class="comment">// [xsp+8h] [xbp-18h]</span></span><br><span class="line">  __int64 v4; <span class="comment">// [xsp+18h] [xbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v1 = <span class="number">0</span>;</span><br><span class="line">  v4 = *(_QWORD *)(_ReadStatusReg(TPIDR_EL0) + <span class="number">40</span>);</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    *((_BYTE *)&amp;v3 + v1) = *((_BYTE *)a1 + dword_5AB30[v1]);</span><br><span class="line">    ++v1;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v1 != <span class="number">16</span> );</span><br><span class="line">  result = v3;</span><br><span class="line">  *(<span class="type">long</span> <span class="type">double</span> *)a1 = v3;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é‚£ä¹ˆä¸Šè¿°çš„æŸ¥è¡¨æ“ä½œå°±æ˜¯å­—èŠ‚ä»£æ¢+åˆ—æ··åˆ+è½®å¯†é’¥åŠ äº†</p>
<p>é‚£ä¹ˆç›´æ¥é€šè¿‡DFA Hookè¡Œç§»ä½å‡½æ•°ï¼Œå°†å…¶ç¬¬ä¸€ä¸ªå‚æ•°éšæœºæ›¿æ¢ä¸€ä½</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">call_AES</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">hexInput</span> <span class="operator">=</span> <span class="string">&quot;E46ED2A1xxxxxxxxx1F44519D2E6452C0810101010101010101010101010101010&quot;</span>;</span><br><span class="line">        <span class="type">byte</span>[] inputData = hexToByteArray(hexInput);</span><br><span class="line"></span><br><span class="line">        <span class="type">UnidbgPointer</span> <span class="variable">inputPtr</span> <span class="operator">=</span> emulator.getMemory().malloc(inputData.length, <span class="literal">true</span>).getPointer();</span><br><span class="line">        inputPtr.write(inputData);</span><br><span class="line"></span><br><span class="line">        <span class="type">UnidbgPointer</span> <span class="variable">outputPtr</span> <span class="operator">=</span> emulator.getMemory().malloc(inputData.length, <span class="literal">true</span>).getPointer();</span><br><span class="line"></span><br><span class="line">        <span class="type">UnidbgPointer</span> <span class="variable">arg1Ptr</span> <span class="operator">=</span> emulator.getMemory().malloc(<span class="number">16</span>, <span class="literal">true</span>).getPointer();</span><br><span class="line"></span><br><span class="line"><span class="comment">//        System.out.println(&quot;=== å¼€å§‹åˆ†å—åŠ å¯† (3è½® x 16å­—èŠ‚) ===&quot;);</span></span><br><span class="line">        emulator.attach().addBreakPoint(<span class="keyword">module</span>.base+<span class="number">0x2636C</span>);</span><br><span class="line">        <span class="keyword">module</span>.callFunction(emulator, <span class="number">0x2636C</span>,</span><br><span class="line">                arg1Ptr,                <span class="comment">// Arg1: å›ºå®š</span></span><br><span class="line">                inputPtr, <span class="comment">// Arg2: è¾“å…¥æŒ‡é’ˆåç§»</span></span><br><span class="line">                outputPtr <span class="comment">// Arg3: è¾“å‡ºæŒ‡é’ˆåç§»</span></span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">res</span> <span class="operator">=</span> bytesToHex(outputPtr.getByteArray(<span class="number">0</span>,<span class="number">0x10</span>));</span><br><span class="line">        System.out.println(res);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">callDfa</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">Debugger</span> <span class="variable">debugger</span> <span class="operator">=</span> emulator.attach();</span><br><span class="line">        debugger.addBreakPoint(<span class="keyword">module</span>.base+<span class="number">0x25938</span>,<span class="keyword">new</span> <span class="title class_">BreakPointCallback</span>() &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onHit</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> address)</span> &#123;</span><br><span class="line">                UnidbgPointer pointer;</span><br><span class="line">                <span class="type">RegisterContext</span> <span class="variable">context</span> <span class="operator">=</span> emulator.getContext();</span><br><span class="line"></span><br><span class="line">                pointer = context.getPointerArg(<span class="number">0</span>);</span><br><span class="line">                <span class="keyword">if</span>(num%<span class="number">9</span>==<span class="number">0</span>)&#123;</span><br><span class="line">                    pointer.setByte(randint(<span class="number">0</span>,<span class="number">15</span>),(<span class="type">byte</span>) randint(<span class="number">0</span>,<span class="number">0xff</span>));</span><br><span class="line">                &#125;</span><br><span class="line"><span class="comment">//                System.out.println(&quot;callDfa num=&quot; + num);</span></span><br><span class="line">                num+=<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">randint</span><span class="params">(<span class="type">int</span> min,<span class="type">int</span> max)</span>&#123;</span><br><span class="line">        <span class="type">Random</span> <span class="variable">rand</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">        <span class="keyword">return</span> rand.nextInt((max-min)+<span class="number">1</span>)+min;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] hexToByteArray(String hex) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> hex.length();</span><br><span class="line">        <span class="type">byte</span>[] data = <span class="keyword">new</span> <span class="title class_">byte</span>[len / <span class="number">2</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; len; i += <span class="number">2</span>) &#123;</span><br><span class="line">            data[i / <span class="number">2</span>] = (<span class="type">byte</span>) ((Character.digit(hex.charAt(i), <span class="number">16</span>) &lt;&lt; <span class="number">4</span>)</span><br><span class="line">                    + Character.digit(hex.charAt(i+<span class="number">1</span>), <span class="number">16</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">bytesToHex</span><span class="params">(<span class="type">byte</span>[] bytes)</span> &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">byte</span> b : bytes) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">unsignedInt</span> <span class="operator">=</span> b &amp; <span class="number">0xff</span>;</span><br><span class="line">            <span class="type">String</span> <span class="variable">hex</span> <span class="operator">=</span> Integer.toHexString(unsignedInt);</span><br><span class="line">            <span class="keyword">if</span> (hex.length() == <span class="number">1</span>) &#123;</span><br><span class="line">                sb.append(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            sb.append(hex);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶ååœ¨mainä¸­200æ¬¡å¾ªç¯è·å–</p>
<p>å‰©ä½™çš„å°±æ˜¯ä½¿ç”¨å·¥å…·è·å–å¯†é’¥äº†</p>
<p>è·å–ç¬¬10è½®å¯†é’¥ï¼š<a target="_blank" rel="noopener" href="https://github.com/SideChannelMarvels/JeanGrey/tree/master/phoenixAES">https://github.com/SideChannelMarvels/JeanGrey/tree/master/phoenixAES</a></p>
<p>è·å–çœŸæ­£çš„å¯†é’¥ï¼š<a target="_blank" rel="noopener" href="https://github.com/SideChannelMarvels/Stark">https://github.com/SideChannelMarvels/Stark</a></p>
<p>æˆåŠŸè·å–<code>68455xxxxxxxx5A5476</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224661.png" alt="image-20251216134122712"></p>
<p>æˆåŠŸè·å–å¯†é’¥</p>
<p><strong>å› æ­¤å¯ä»¥å¾—çŸ¥CRCçš„x0å°±æ˜¯é€šè¿‡æ ‡å‡†AES ECB 128 åŠ å¯† HMAC-SHA256 ç»“æœçš„å€¼</strong></p>
<p><code>cab68c9fxxxxxxx88de61509c5dxxxxxxxxc4948fe0ed8ea4aab0c1d5f4519f8d19c4948f</code></p>
<p>ç»“æœæˆªå–96ä¸ªå­—ç¬¦å°±æ˜¯CRCçš„x0äº†</p>
<p><code>cab68c9fxxxxxxx88de61509c5dxxxxxxxxc4948f</code></p>
<h3 id="CRC32"><a href="#CRC32" class="headerlink" title="CRC32"></a>CRC32</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.rodata:<span class="number">0000000000057</span>C78 CRC32b_poly_Constant_57C78 DCD <span class="number">0x4C11DB7</span></span><br><span class="line">.rodata:<span class="number">0000000000057</span>C78                                         ; DATA XREF: sub_11BDC+BCâ†‘o</span><br><span class="line">.rodata:<span class="number">0000000000057</span>C78                                         ; sub_11BDC+D4â†‘o ...</span><br><span class="line">.rodata:<span class="number">0000000000057</span>C7C                 DCD <span class="number">0xFFFFFFFF</span></span><br><span class="line">.rodata:<span class="number">0000000000057</span>C80                 DCD <span class="number">0xFFFFFFFF</span></span><br><span class="line">.rodata:<span class="number">0000000000057</span>C84                 DCD <span class="number">0x101</span></span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">__int64 __fastcall <span class="title">sub_120C4</span><span class="params">(<span class="type">unsigned</span> __int8 *a1, __int64 a2, <span class="type">unsigned</span> <span class="type">int</span> *a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// w9</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// w12</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// w10</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// w11</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// w8</span></span><br><span class="line">  __int64 v8; <span class="comment">// x10</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 v9; <span class="comment">// w8</span></span><br><span class="line">  __int64 v10; <span class="comment">// x11</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// w11</span></span><br><span class="line">  <span class="type">int</span> v12; <span class="comment">// w10</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// w0</span></span><br><span class="line">  <span class="type">int</span> v15; <span class="comment">// w8</span></span><br><span class="line">  __int64 v16; <span class="comment">// [xsp+0h] [xbp-30h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> *v17; <span class="comment">// [xsp+8h] [xbp-28h]</span></span><br><span class="line">  <span class="type">int</span> v18; <span class="comment">// [xsp+14h] [xbp-1Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> __int8 *v19; <span class="comment">// [xsp+18h] [xbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v3 = a3[<span class="number">1</span>];</span><br><span class="line">  <span class="keyword">if</span> ( *((_BYTE *)a3 + <span class="number">12</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = *a3;</span><br><span class="line">    v5 = <span class="number">0</span>;</span><br><span class="line">    v6 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      ++v5;</span><br><span class="line">      v7 = v4 &amp; <span class="number">1</span> | (<span class="number">2</span> * v6);</span><br><span class="line">      v4 &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">      v6 = v7;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( (<span class="type">unsigned</span> __int16)v5 &lt; <span class="number">0x20</span>u );</span><br><span class="line">    <span class="keyword">for</span> ( ; a2; ++a1 )</span><br><span class="line">    &#123;</span><br><span class="line">      v3 ^= *a1;</span><br><span class="line">      v8 = <span class="number">8</span>;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        --v8;</span><br><span class="line">        v3 = (v3 &lt;&lt; <span class="number">31</span> &gt;&gt; <span class="number">31</span>) &amp; v7 ^ ((<span class="type">unsigned</span> <span class="type">int</span>)v3 &gt;&gt; <span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v8 );</span><br><span class="line">      --a2;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v9 = <span class="built_in">atomic_load</span>((<span class="type">unsigned</span> __int8 *)&amp;byte_72638);</span><br><span class="line">    <span class="keyword">if</span> ( (v9 &amp; <span class="number">1</span>) == <span class="number">0</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v19 = a1;</span><br><span class="line">      v16 = a2;</span><br><span class="line">      v17 = a3;</span><br><span class="line">      v18 = a3[<span class="number">1</span>];</span><br><span class="line">      v14 = __cxa_guard_acquire((__guard *)&amp;byte_72638);</span><br><span class="line">      v3 = v18;</span><br><span class="line">      a2 = v16;</span><br><span class="line">      a3 = v17;</span><br><span class="line">      v15 = v14;</span><br><span class="line">      a1 = v19;</span><br><span class="line">      <span class="keyword">if</span> ( v15 )</span><br><span class="line">      &#123;</span><br><span class="line">        dword_72634 = <span class="number">24</span>;</span><br><span class="line">        __cxa_guard_release((__guard *)&amp;byte_72638);</span><br><span class="line">        v3 = v18;</span><br><span class="line">        a1 = v19;</span><br><span class="line">        a2 = v16;</span><br><span class="line">        a3 = v17;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> ( ; a2; ++a1 )</span><br><span class="line">    &#123;</span><br><span class="line">      v3 ^= *a1 &lt;&lt; dword_72634;</span><br><span class="line">      v10 = <span class="number">8</span>;</span><br><span class="line">      <span class="keyword">do</span></span><br><span class="line">      &#123;</span><br><span class="line">        --v10;</span><br><span class="line">        v3 = *a3 &amp; (v3 &gt;&gt; <span class="number">31</span>) ^ (<span class="number">2</span> * v3);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">while</span> ( v10 );</span><br><span class="line">      --a2;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( *((<span class="type">unsigned</span> __int8 *)a3 + <span class="number">12</span>) == *((<span class="type">unsigned</span> __int8 *)a3 + <span class="number">13</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    v11 = v3;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v12 = <span class="number">0</span>;</span><br><span class="line">    v11 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">      ++v12;</span><br><span class="line">      v11 = v3 &amp; <span class="number">1</span> | (<span class="number">2</span> * v11);</span><br><span class="line">      v3 = (<span class="type">unsigned</span> <span class="type">int</span>)v3 &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> ( (<span class="type">unsigned</span> __int16)v12 &lt; <span class="number">0x20</span>u );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v11 ^ a3[<span class="number">2</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ ¹æ®a3çš„é…ç½®ï¼Œå¯ä»¥çŸ¥é“è¿™é‡Œæ‰§è¡Œçš„CRC32æ˜¯æ ‡å‡†çš„CRC32</p>
<p>å³é¦–å…ˆå°†a3çš„ç¬¬ä¸€ä¸ª4å­—èŠ‚å…ˆè¿›è¡Œ32ä½çš„é•œåƒåè½¬</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">v4 = *a3;</span><br><span class="line">v5 = <span class="number">0</span>;</span><br><span class="line">v6 = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">  ++v5;</span><br><span class="line">  v7 = v4 &amp; <span class="number">1</span> | (<span class="number">2</span> * v6);</span><br><span class="line">  v4 &gt;&gt; = <span class="number">1</span>;</span><br><span class="line">  v6 = v7;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> ( (<span class="type">unsigned</span> __int16)v5 &lt; <span class="number">0x20</span>u );</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œå°±æ˜¯å°†4å­—èŠ‚é“ºå¹³æˆ32bitï¼Œç„¶åç¬¬0bitå’Œç¬¬31bitè¿›è¡Œäº¤æ¢â€¦â€¦</p>
<p>0x04C11DB7 -&gt; 0xEDB88320</p>
<p>ç„¶åé€å­—èŠ‚å¤„ç†-&gt;é€ä½è®¡ç®—ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( ; a2; ++a1 )</span><br><span class="line">&#123;</span><br><span class="line">  v3 ^= *a1;</span><br><span class="line">  v8 = <span class="number">8</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    --v8;</span><br><span class="line">    v3 = (v3 &lt;&lt; <span class="number">31</span> &gt;&gt; <span class="number">31</span>) &amp; v7 ^ ((<span class="type">unsigned</span> <span class="type">int</span>)v3 &gt;&gt; <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v8 );</span><br><span class="line">  --a2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¨¡æ‹ŸäºŒè¿›åˆ¶é™¤æ³•ï¼ˆå…¶å®å°±æ˜¯ç§»ä½å’Œå¼‚æˆ–ï¼‰</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v11 = v3;</span><br><span class="line"><span class="keyword">return</span> v11 ^ a3[<span class="number">2</span>];</span><br></pre></td></tr></table></figure>

<p>æœ€åç›´æ¥return <code>v3 ^ 0xFFFFFFFF</code></p>
<p>å¯ä»¥ç›´æ¥è°ƒç”¨pythonçš„zlib-crc32åº“ï¼Œä½†æ˜¯å‘ç°å…¶ä»£ç é‡å¹¶ä¸å¤šï¼Œç›´æ¥å†™é€»è¾‘å³å¯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sub_120C4_simulation</span>(<span class="params">hex_string</span>):</span><br><span class="line"></span><br><span class="line">    CONFIG_POLY = <span class="number">0x04C11DB7</span>  <span class="comment"># *a3</span></span><br><span class="line">    CONFIG_INIT = <span class="number">0xFFFFFFFF</span>  <span class="comment"># a3[1]</span></span><br><span class="line">    CONFIG_XOR_OUT = <span class="number">0xFFFFFFFF</span>  <span class="comment"># a3[2]</span></span><br><span class="line">    FLAG_REF_IN = <span class="literal">True</span></span><br><span class="line">    FLAG_REF_OUT = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data = <span class="built_in">bytes</span>.fromhex(hex_string)</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    v3 = CONFIG_INIT</span><br><span class="line">    <span class="keyword">if</span> FLAG_REF_IN:</span><br><span class="line"></span><br><span class="line">        v4 = CONFIG_POLY</span><br><span class="line">        v5 = <span class="number">0</span></span><br><span class="line">        v6 = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">            v5 += <span class="number">1</span></span><br><span class="line">            v7 = (v4 &amp; <span class="number">1</span>) | ((v6 &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xFFFFFFFF</span>)</span><br><span class="line">            v4 &gt;&gt; = <span class="number">1</span></span><br><span class="line">            v6 = v7</span><br><span class="line"></span><br><span class="line">        poly_reversed = v6</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> byte <span class="keyword">in</span> data:</span><br><span class="line">            v3 ^ = byte</span><br><span class="line"></span><br><span class="line">            v8 = <span class="number">8</span></span><br><span class="line">            <span class="keyword">while</span> v8 &gt; <span class="number">0</span>:</span><br><span class="line">                v8 - = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (v3 &amp; <span class="number">1</span>) == <span class="number">1</span>:</span><br><span class="line">                    v3 = (v3 &gt;&gt; <span class="number">1</span>) ^ poly_reversed</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    v3 = (v3 &gt;&gt; <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> FLAG_REF_IN == FLAG_REF_OUT:</span><br><span class="line">        v11 = v3</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        v11 = v3</span><br><span class="line"></span><br><span class="line">    result = v11 ^ CONFIG_XOR_OUT</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">input_hex_std = <span class="string">&quot;cab68c9fxxxxxxxxd8ea4aab0c1d5f4519f8d19c4948f&quot;</span></span><br><span class="line">crc_val_std = sub_120C4_simulation(input_hex_std)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;è¾“å…¥ Hex: <span class="subst">&#123;input_hex_std&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;è®¡ç®—ç»“æœ: <span class="subst">&#123;<span class="built_in">hex</span>(crc_val_std).upper()&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ Hex: cab68c9f7xxxxxxxa4aab0c1d5f4519f8d19c4948f</span><br><span class="line">è®¡ç®—ç»“æœ: 0XE40xx7FA</span><br></pre></td></tr></table></figure>

<p>ç»è¿‡è°ƒè¯•ç¡®è®¤ç»“æœçš„ä¸€è‡´ï¼</p>
<h3 id="4"><a href="#4" class="headerlink" title="4:"></a>4:</h3><p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224662.png" alt="image-20251216142405479"></p>
<p>çœ‹ç€å°±åƒæ˜¯æ—¶é—´æˆ³</p>
<p>è°ƒè¯•å‘ç°æ˜¯</p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224663.png" alt="image-20251216142508300"></p>
<img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224664.png" alt="image-20251216142527223" style="zoom:25%;" />

<p>å°±æ˜¯ä¸Šè¿°æˆ‘ä»¬å¡«å…¥çš„æ—¶é—´æˆ³<code>1960949932368L / 1000</code></p>
<h3 id="2"><a href="#2" class="headerlink" title="2:"></a>2:</h3><p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224665.png" alt="image-20251216143106130"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">LDAXR           W9, [X8]</span><br><span class="line">STLXR           W10, W9, [X8]</span><br></pre></td></tr></table></figure>

<p>LDå’ŒSTåˆ†åˆ«æ˜¯åŠ è½½å’Œè½½å…¥ï¼ŒXæ˜¯ç‹¬å çš„è¯­ä¹‰ï¼Œè¯´æ˜åœ¨è¿™ä¸ªæœŸé—´X8æŒ‡å‘çš„å†…å­˜åªæœ‰è¿™æ¡æ±‡ç¼–å¯ä»¥æ”¹å†™ï¼Œå¦‚æœå†™å…¥æœŸé—´å‘ç°æœ‰å…¶ä»–çš„çº¿ç¨‹ä¿®æ”¹äº†è¿™ä¸ªå†…å­˜åœ°å€ï¼Œé‚£ä¹ˆä¼šè¿”å›1ï¼Œç»§ç»­è¯»å–ç„¶åè‡ªå¢ï¼Œå¦‚æœæ²¡æœ‰å°±ç›´æ¥è¿”å›0é€€å‡ºè¿™ä¸ªå¾ªç¯</p>
<p>å…¶å®è¯´ç™½äº†ï¼Œå°±æ˜¯ä¸€ä¸ªè‡ªå¢å™¨ï¼Œç¡®ä¿å†…å®¹çš„å”¯ä¸€æ€§</p>
<p>è€Œv68å°±æ˜¯ä¸€ä¸ªåŸå­é€’å¢åçš„æ–°åºåˆ—å·ï¼Œè¿™æ ·æ¯å‘ä¸€æ¬¡åŒ…ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„è¯·æ±‚IDï¼</p>
<p><strong>çŒœæµ‹æœåŠ¡ç«¯æ¥æ”¶æ—¶ä¼šæŒ‰ç…§è¿™ä¸ªIDæ¥è¿›è¡Œå¯¹æŠ—</strong></p>
<h3 id="5"><a href="#5" class="headerlink" title="5:"></a>5:</h3><p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224666.png" alt="image-20251216144336964"></p>
<p>è¿™é‡Œè°ƒè¯•å‘ç°ç»“æœéƒ½æ˜¯0xd00ï¼ˆQwQè¿™é‡Œæ„Ÿè§‰å¦‚æœæ˜¯å›ºå®šçš„å°±å¾ˆç®€å•ï¼Œä¼°è®¡ä¸åŒçš„åŠŸèƒ½è¿™é‡Œæ˜¯ä¸ä¸€æ ·çš„ï¼Œä½†æ˜¯æœ‰ç‚¹å¤æ‚ï¼Œè¿™é‡Œåªè€ƒè™‘å½“å‰æƒ…å†µï¼‰</p>
<p>å¯ä»¥åšä¸ªç®€å•çš„å°æ€»ç»“</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">SignatureBlock</span> &#123;</span><br><span class="line">    <span class="type">int</span> magic;       <span class="comment">// [0] 0x4151 (ASCII &#x27;AQ&#x27;) - å¤´éƒ¨é­”æ•°                 0x41512200</span></span><br><span class="line">    <span class="type">int</span> user_id;     <span class="comment">// [1] ç”¨æˆ·ID æˆ– ç›å€¼ (ä» qword_72998 è·å–)            0x1dbxxe7f</span></span><br><span class="line">    <span class="type">int</span> seq_id;      <span class="comment">// [2] åºåˆ—å· (åŸå­è‡ªå¢ v68)</span></span><br><span class="line">    <span class="type">int</span> crc32;       <span class="comment">// [3] æ•°æ®çš„æ ¡éªŒå’Œ (CRC32_120C4)</span></span><br><span class="line">    <span class="type">int</span> timestamp;   <span class="comment">// [4] å½“å‰æ—¶é—´æˆ³ (gettimeofday)</span></span><br><span class="line">    <span class="type">int</span> feature_mask;<span class="comment">// [5] &lt;--- è¿™é‡Œå°±æ˜¯ v72 (ç‰¹æ€§æ©ç )                     0xd00</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<p>ä¹‹å‰ä»¥ä¸ºåˆ°è¿™é‡Œè¿˜æ²¡ç»“æŸï¼Œå…¶å®æ˜¯å·²ç»ç»“æŸäº†ï¼Œå› ä¸ºä¹‹å‰è¯´æ˜¯éœ€è¦48ä¸ªå­—èŠ‚æ˜¯å› ä¸ºé»˜è®¤å…¶é€šè¿‡ç¼–ç å­˜å‚¨ï¼Œä½†æ˜¯å‘ç°éƒ½æ˜¯é€šè¿‡Hexå­˜å‚¨çš„ï¼Œä¹‹ååªéœ€è¦æ•´ç†ä¸€ä¸‹å†™ä¸ªçº¯ç®—pythonå³å¯</p>
<p><img src="https://cdn.jsdelivr.net/gh/s1nec-1o/photo@main/img/202512162224667.png" alt="image-20251216154209057"></p>
<p>è¿™é‡Œå°±æ˜¯å¼‚æˆ–ï¼Œè¿˜åŸä¸€ä¸‹å³å¯ï¼Œæ²¡ä»€ä¹ˆéš¾åº¦ã€‚ä¹‹åå°±å¯ä»¥æŒ‰ç…§è¿™ä¸ªå†™å‡ºsig3çš„çº¯ç®—pythonäº†</p>
<p>è´´ä¸€ä¸‹è¿™éƒ¨åˆ†çš„ä»£ç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">simulate_obfuscation</span>(<span class="params">packed_data_bytes</span>):</span><br><span class="line">    final_result = <span class="built_in">bytearray</span>(packed_data_bytes)</span><br><span class="line"></span><br><span class="line">    v71 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">23</span>):</span><br><span class="line">        v73 = final_result[i]</span><br><span class="line">        v71 += v73</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> v71 &gt; <span class="number">0xFF</span>:</span><br><span class="line">        v71 = -v71</span><br><span class="line"></span><br><span class="line">    v72 = <span class="number">0xd00</span></span><br><span class="line"></span><br><span class="line">    v71_32bit = v71 &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    shifted_v71 = (v71_32bit &lt;&lt; <span class="number">24</span>) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line">    new_int_val = v72 | shifted_v71</span><br><span class="line"></span><br><span class="line">    struct.pack_into(<span class="string">&#x27;&lt;I&#x27;</span>, final_result, <span class="number">20</span>, new_int_val)</span><br><span class="line"></span><br><span class="line">    v71_low_byte = v71 &amp; <span class="number">0xFF</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> v74 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">23</span>):</span><br><span class="line">        xor_key = v71_low_byte ^ (v74 &amp; <span class="number">0xFF</span>)</span><br><span class="line">        final_result[v74] ^= xor_key</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> final_result</span><br></pre></td></tr></table></figure>

<p>ä¹Ÿä¸ä¼šç‰¹åˆ«å›°éš¾ï¼Œå…¶ä¸­v72æ˜¯ä¹‹å‰çš„0xd00ï¼Œæœ‰ä¸ªå¯èƒ½ä¼šå‡ºç°çš„é—®é¢˜å°±æ˜¯range(23)è€Œä¸æ˜¯range(24)æ ¹æ®é€†å‘å¯çŸ¥å…¶ä¸ä¼šå¯¹æœ€åä¸€ä½è¿›è¡Œå¼‚æˆ–å¤„ç†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">hmac = HMAC_SHA256(input_val)</span><br><span class="line">aes_result = aes_ecb_encrypt(hmac, aes_key)</span><br><span class="line">crc32_result = sub_120C4_simulation(aes_result)</span><br><span class="line">packed_data = struct.pack(<span class="string">&#x27;&lt;6I&#x27;</span>,</span><br><span class="line">                                  magic,</span><br><span class="line">                                  user_id,</span><br><span class="line">                                  seq_id,</span><br><span class="line">                                  crc32_result,</span><br><span class="line">                                  time,</span><br><span class="line">                                  feature_mask)</span><br><span class="line">result1 = simulate_obfuscation(packed_data)</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™ä¸ªç®—æ³•æ€»çš„æ¥è¯´å°±æ˜¯<code>HMAC-SHA256 -&gt; AES-128 -&gt; CRC32</code></p>
<p>æ€»ä½“éš¾åº¦ä¸é«˜QwQ</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="http://s1nec-1o.github.io">s1nec-1o</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://s1nec-1o.github.io/2025/12/17/Android%E5%AE%9E%E6%88%98%E4%B9%8Bsig3%E7%BA%AF%E7%AE%97%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/">http://s1nec-1o.github.io/2025/12/17/Android%E5%AE%9E%E6%88%98%E4%B9%8Bsig3%E7%BA%AF%E7%AE%97%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://s1nec-1o.github.io" target="_blank">S1nec-1o's B1og</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/android/">android</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281614288.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2025/11/18/Android%E8%AE%BE%E5%A4%87%E6%8C%87%E7%BA%B9%E9%87%87%E9%9B%86%E5%AE%9E%E8%B7%B5/" title="Androidè®¾å¤‡æŒ‡çº¹é‡‡é›†å®è·µ"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">Androidè®¾å¤‡æŒ‡çº¹é‡‡é›†å®è·µ</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/2025/11/03/Android%E9%80%86%E5%90%91%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F%E4%B9%8BAntiFakerAndroidChecker/" title="Androidé€†å‘ä»å…¥é—¨åˆ°å…¥åœŸä¹‹AntiFakerAndroidChecker(3)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-03</div><div class="title">Androidé€†å‘ä»å…¥é—¨åˆ°å…¥åœŸä¹‹AntiFakerAndroidChecker(3)</div></div></a></div><div><a href="/2025/04/14/Android%E9%80%86%E5%90%91%E4%B9%8BWiki%E7%AF%87/" title="Androidé€†å‘ä¹‹Wikiç¯‡"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-14</div><div class="title">Androidé€†å‘ä¹‹Wikiç¯‡</div></div></a></div><div><a href="/2025/10/11/Android%E9%80%86%E5%90%91%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F-1/" title="Androidé€†å‘ä»å…¥é—¨åˆ°å…¥åœŸ(1)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-11</div><div class="title">Androidé€†å‘ä»å…¥é—¨åˆ°å…¥åœŸ(1)</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281614288.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">s1nec-1o</div><div class="author-info__description">ä¸‡äº‹èƒœæ„</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">52</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">18</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">26</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="http://github.com/s1nec-1o"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">æ­£åœ¨å­¦ä¹ iot pwn æ¬¢è¿å¹¿å¤§å¸ˆå‚…ä¸æˆ‘äº¤æµ</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%93%E5%8C%85%E5%88%86%E6%9E%90"><span class="toc-number">1.</span> <span class="toc-text">æŠ“åŒ…åˆ†æ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Java%E5%B1%82%E6%B5%85%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">Javaå±‚æµ…æ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sig%E6%8C%87%E7%BA%B9"><span class="toc-number">2.1.</span> <span class="toc-text">sigæŒ‡çº¹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sig3%E4%BC%A0%E5%85%A5"><span class="toc-number">2.2.</span> <span class="toc-text">sig3ä¼ å…¥</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Native%E5%B1%82%E6%B5%85%E6%9E%90"><span class="toc-number">3.</span> <span class="toc-text">Nativeå±‚æµ…æ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A5%E5%8F%A3"><span class="toc-number">3.1.</span> <span class="toc-text">å…¥å£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unidbg%E9%85%8D%E5%90%88%E9%9D%99%E6%80%81%E5%88%86%E6%9E%90"><span class="toc-number">3.2.</span> <span class="toc-text">unidbgé…åˆé™æ€åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HMAC-SHA256"><span class="toc-number">3.3.</span> <span class="toc-text">HMAC-SHA256</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0"><span class="toc-number">3.4.</span> <span class="toc-text">0:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1"><span class="toc-number">3.5.</span> <span class="toc-text">1:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3"><span class="toc-number">3.6.</span> <span class="toc-text">3:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wbAES"><span class="toc-number">3.7.</span> <span class="toc-text">wbAES</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CRC32"><span class="toc-number">3.8.</span> <span class="toc-text">CRC32</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4"><span class="toc-number">3.9.</span> <span class="toc-text">4:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2"><span class="toc-number">3.10.</span> <span class="toc-text">2:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5"><span class="toc-number">3.11.</span> <span class="toc-text">5:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">4.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/17/Android%E5%AE%9E%E6%88%98%E4%B9%8Bsig3%E7%BA%AF%E7%AE%97%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/" title="Androidå®æˆ˜ä¹‹sig3çº¯ç®—é€†å‘åˆ†æ">Androidå®æˆ˜ä¹‹sig3çº¯ç®—é€†å‘åˆ†æ</a><time datetime="2025-12-17T08:41:37.000Z" title="å‘è¡¨äº 2025-12-17 16:41:37">2025-12-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/18/Android%E8%AE%BE%E5%A4%87%E6%8C%87%E7%BA%B9%E9%87%87%E9%9B%86%E5%AE%9E%E8%B7%B5/" title="Androidè®¾å¤‡æŒ‡çº¹é‡‡é›†å®è·µ">Androidè®¾å¤‡æŒ‡çº¹é‡‡é›†å®è·µ</a><time datetime="2025-11-18T08:32:20.000Z" title="å‘è¡¨äº 2025-11-18 16:32:20">2025-11-18</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/03/Android%E9%80%86%E5%90%91%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F%E4%B9%8BAntiFakerAndroidChecker/" title="Androidé€†å‘ä»å…¥é—¨åˆ°å…¥åœŸä¹‹AntiFakerAndroidChecker(3)">Androidé€†å‘ä»å…¥é—¨åˆ°å…¥åœŸä¹‹AntiFakerAndroidChecker(3)</a><time datetime="2025-11-03T13:26:59.000Z" title="å‘è¡¨äº 2025-11-03 21:26:59">2025-11-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/21/Android%E9%80%86%E5%90%91%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F%E4%B9%8B%E5%88%9D%E8%AF%86%E9%A3%8E%E6%8E%A7-2/" title="Androidé€†å‘ä»å…¥é—¨åˆ°å…¥åœŸä¹‹åˆè¯†é£æ§(2)">Androidé€†å‘ä»å…¥é—¨åˆ°å…¥åœŸä¹‹åˆè¯†é£æ§(2)</a><time datetime="2025-10-21T14:17:54.000Z" title="å‘è¡¨äº 2025-10-21 22:17:54">2025-10-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/11/Android%E9%80%86%E5%90%91%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E5%9C%9F-1/" title="Androidé€†å‘ä»å…¥é—¨åˆ°å…¥åœŸ(1)">Androidé€†å‘ä»å…¥é—¨åˆ°å…¥åœŸ(1)</a><time datetime="2025-10-11T06:38:08.000Z" title="å‘è¡¨äº 2025-10-11 14:38:08">2025-10-11</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281616326.png')"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By s1nec-1o</div><div class="footer_custom_text">ä»‹æ˜¯s1nec-1oçš„åšå®¢</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.12.0"></script><script src="/js/main.js?v=4.12.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><div><canvas id="snow" style="position:fixed;top:0;left:0;width:100%;height:100%;z-index:99999;pointer-events:none"></canvas></div><script>const notMobile = (!(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)));</script><script async type="text/javascript" src="https://cdn.jsdelivr.net/gh/Candinya/Kratos-Rebirth@latest/source/js/snow.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>